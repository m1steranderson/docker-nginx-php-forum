<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_forums_front_topics extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '9a31bead714a37eaad3463cd04f1621d';\n\tfunction activity( $topic, $location ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$lastPoster = \\IPS\\Member::load( $topic->last_poster_id);\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$members = $topic->topPosters(4);\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$busy = $topic->showSummaryFeature('popularDays') ? $topic->popularDays(4) : FALSE;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$reacted = $topic->showSummaryFeature('topPost') ? $topic->topReactedPosts(3) : FALSE;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$images = $topic->showSummaryFeature('uploads') ? $topic->imageAttachments(4) : FALSE;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$isQA = $topic->container()->forums_bitoptions['bw_enable_answers'];\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $location == 'sidebar' ):\n$return .= <<<CONTENT\n\n<div class=\"ipsBox ipsResponsive_hideTablet ipsResponsive_hidePhone cTopicOverview cTopicOverview--sidebar ipsFlex ipsFlex-fd:column md:ipsFlex-fd:row sm:ipsFlex-fd:column\" data-controller='forums.front.topic.activity'>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<div class=\"ipsBox cTopicOverview cTopicOverview--inline ipsFlex ipsFlex-fd:row md:ipsFlex-fd:row sm:ipsFlex-fd:column ipsMargin_bottom sm:ipsMargin_bottom:half sm:ipsMargin_top:half ipsResponsive_pull \nCONTENT;\n\nif ( $topic->showSummaryOnDesktop() != 'post' ):\n$return .= <<<CONTENT\nipsResponsive_hideDesktop ipsResponsive_block\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( ! $topic->showSummaryOnMobile() ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone ipsResponsive_block\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-controller='forums.front.topic.activity'>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='cTopicOverview__header ipsAreaBackground_light ipsFlex sm:ipsFlex-fw:wrap sm:ipsFlex-jc:center'>\n\t\t<ul class='cTopicOverview__stats ipsPadding ipsMargin:none sm:ipsPadding_horizontal:half ipsFlex ipsFlex-flex:10 ipsFlex-jc:around ipsFlex-ai:center'>\n\t\t\t<li class='cTopicOverview__statItem ipsType_center'>\n\t\t\t\t<span class='cTopicOverview__statTitle ipsType_light ipsTruncate ipsTruncate_line'>\nCONTENT;\n\nif ( $isQA ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forum_preview_posts_answers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<span class='cTopicOverview__statValue'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumberShort( $topic->posts-1 );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/li>\n\t\t\t<li class='cTopicOverview__statItem ipsType_center'>\n\t\t\t\t<span class='cTopicOverview__statTitle ipsType_light ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_created', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<span class='cTopicOverview__statValue'>\nCONTENT;\n\n$val = ( $topic->start_date instanceof \\IPS\\DateTime ) ? $topic->start_date : \\IPS\\DateTime::ts( $topic->start_date );$return .= $val->html(TRUE, TRUE);\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/li>\n\t\t\t<li class='cTopicOverview__statItem ipsType_center'>\n\t\t\t\t<span class='cTopicOverview__statTitle ipsType_light ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'last_reply', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<span class='cTopicOverview__statValue'>\nCONTENT;\n\n$val = ( $topic->last_post instanceof \\IPS\\DateTime ) ? $topic->last_post : \\IPS\\DateTime::ts( $topic->last_post );$return .= $val->html(TRUE, TRUE);\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t\t<a href='#' data-action='toggleOverview' class='cTopicOverview__toggle cTopicOverview__toggle--inline ipsType_large ipsType_light ipsPad ipsFlex ipsFlex-ai:center ipsFlex-jc:center'><i class='fa fa-chevron-down'><\/i><\/a>\n\t<\/div>\n\t\nCONTENT;\n\nif ( $location !== 'sidebar' ):\n$return .= <<<CONTENT\n\n\t\t<div class='cTopicOverview__preview ipsFlex-flex:10' data-role=\"preview\">\n\t\t\t<div class='cTopicOverview__previewInner ipsPadding_vertical ipsPadding_horizontal ipsResponsive_hidePhone ipsFlex ipsFlex-fd:row'>\n\t\t\t\t\nCONTENT;\n\nif ( $members ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='cTopicOverview__section--users ipsFlex-flex:00'>\n\t\t\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_dark ipsType_uppercase ipsType_noBreak'>\nCONTENT;\n\nif ( $isQA ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_topposters_qa', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_topposters', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\t\t<ul class='cTopicOverview__dataList ipsMargin:none ipsPadding:none ipsList_style:none ipsFlex ipsFlex-jc:between ipsFlex-ai:center'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $members as $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class=\"cTopicOverview__dataItem ipsMargin_right ipsFlex ipsFlex-jc:start ipsFlex-ai:center\">\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $data['member'], 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<p class='ipsMargin:none ipsPadding_left:half ipsPadding_right ipsType_right'>\nCONTENT;\n$return .= htmlspecialchars( $data['count'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $busy ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='cTopicOverview__section--popularDays ipsFlex-flex:00 ipsPadding_left ipsPadding_left:double'>\n\t\t\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_dark ipsType_uppercase ipsType_noBreak'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_populardays', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\t\t<ul class='cTopicOverview__dataList ipsMargin:none ipsPadding:none ipsList_style:none ipsFlex ipsFlex-jc:between ipsFlex-ai:center'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $busy as $row ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsFlex-flex:10'>\n\t\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $row['commentId'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class='cTopicOverview__dataItem ipsMargin_right ipsType_blendLinks ipsFlex ipsFlex-jc:between ipsFlex-ai:center'>\n\t\t\t\t\t\t\t\t\t\t<p class='ipsMargin:none'>\nCONTENT;\n$return .= htmlspecialchars( $row['date']->dayAndShortMonth(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t\t\t\t<p class='ipsMargin:none ipsMargin_horizontal ipsType_light'>\nCONTENT;\n$return .= htmlspecialchars( $row['count'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='cTopicOverview__body ipsPadding \nCONTENT;\n\nif ( $location !== 'sidebar' ):\n$return .= <<<CONTENT\nipsHide ipsFlex ipsFlex-flex:11 ipsFlex-fd:column\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role=\"overview\">\n\t\t\nCONTENT;\n\nif ( $members ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='cTopicOverview__section--users ipsMargin_bottom'>\n\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_withHr ipsType_dark ipsType_uppercase ipsMargin_bottom'>\nCONTENT;\n\nif ( $isQA ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_topposters_qa', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_topposters', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<ul class='cTopicOverview__dataList ipsList_reset ipsFlex \nCONTENT;\n\nif ( $location == 'sidebar' ):\n$return .= <<<CONTENT\nipsFlex-jc:between\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsFlex-jc:start\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:8 ipsGap_row:5'>\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $members as $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"cTopicOverview__dataItem cTopicOverview__dataItem--split ipsFlex ipsFlex-jc:start ipsFlex-ai:center ipsFlex-flex:11\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $data['member'], 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<p class='ipsMargin:none ipsMargin_left:half cTopicOverview__dataItemInner ipsType_left'>\n\t\t\t\t\t\t\t\t<strong class='ipsTruncate ipsTruncate_line'><a href='\nCONTENT;\n$return .= htmlspecialchars( $data['member']->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>\nCONTENT;\n$return .= htmlspecialchars( $data['member']->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/strong>\n\t\t\t\t\t\t\t\t<span class='ipsType_light'>\nCONTENT;\n\n$pluralize = array( $data['count'] ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_number_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $busy ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='cTopicOverview__section--popularDays ipsMargin_bottom'>\n\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_withHr ipsType_dark ipsType_uppercase ipsMargin_top:half ipsMargin_bottom'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_populardays', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<ul class='cTopicOverview__dataList ipsList_reset ipsFlex \nCONTENT;\n\nif ( $location == 'sidebar' ):\n$return .= <<<CONTENT\nipsFlex-jc:between\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsFlex-jc:start\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:8 ipsGap_row:5'>\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $busy as $row ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsFlex-flex:10'>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $row['commentId'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class='cTopicOverview__dataItem ipsType_blendLinks'>\n\t\t\t\t\t\t\t\t<p class='ipsMargin:none ipsType_bold'>\nCONTENT;\n$return .= htmlspecialchars( $row['date']->dayAndShortMonth(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $row['date']->format('Y'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t\t<p class='ipsMargin:none ipsType_light'>\nCONTENT;\n\n$pluralize = array( $row['count'] ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_number_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $reacted ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='cTopicOverview__section--topPost ipsMargin_bottom'>\n\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_withHr ipsType_dark ipsType_uppercase ipsMargin_top:half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_popularposts', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\nCONTENT;\n\nforeach ( $reacted as $data ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $data['comment']->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class=\"ipsType_noLinkStyling ipsBlock\">\n\t\t\t\t\t\t<div class='ipsPhotoPanel ipsPhotoPanel_tiny ipsClearfix ipsMargin_top'>\n\t\t\t\t\t\t\t<span class='ipsUserPhoto ipsUserPhoto_tiny'>\n\t\t\t\t\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $data['comment']->author()->photo, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='\nCONTENT;\n$return .= htmlspecialchars( $data['comment']->author()->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h5 class='ipsType_reset ipsType_bold ipsType_normal ipsType_blendLinks'>\nCONTENT;\n$return .= htmlspecialchars( $data['comment']->author()->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t\t\t\t\t\t<p class='ipsMargin:none ipsType_light ipsType_resetLh'>\nCONTENT;\n\n$val = ( $data['comment']->mapped('date') instanceof \\IPS\\DateTime ) ? $data['comment']->mapped('date') : \\IPS\\DateTime::ts( $data['comment']->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<p class='ipsMargin:none ipsMargin_top:half ipsType_medium ipsType_richText' data-ipsTruncate data-ipsTruncate-size='3 lines' data-ipsTruncate-type='remove'>\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $data['comment']->truncated(true, 200), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $images ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='cTopicOverview__section--images'>\n\t\t\t\t<h4 class='ipsType_reset cTopicOverview__sectionTitle ipsType_withHr ipsType_dark ipsType_uppercase ipsMargin_top:half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topicactivity_images', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<div class=\"ipsMargin_top:half\" data-controller='core.front.core.lightboxedImages'>\n\t\t\t\t\t<ul class='cTopicOverview__imageGrid ipsMargin:none ipsPadding:none ipsList_style:none ipsFlex ipsFlex-fw:wrap'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $images as $row ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$image = \\IPS\\File::get( 'core_Attachment', ( $row['attach_thumb_location'] ) ? $row['attach_thumb_location'] : $row['attach_location'] )->url;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='cTopicOverview__image'>\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $row['commentUrl'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class='ipsThumb ipsThumb_bg' data-background-src=\"\nCONTENT;\n$return .= htmlspecialchars( $image, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-src=\"\nCONTENT;\n$return .= htmlspecialchars( $image, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( $location !== 'sidebar' ):\n$return .= <<<CONTENT\n\n\t\t<a href='#' data-action='toggleOverview' class='cTopicOverview__toggle cTopicOverview__toggle--afterStats ipsType_large ipsType_light ipsPad ipsFlex ipsFlex-ai:center ipsFlex-jc:center'><i class='fa fa-chevron-down'><\/i><\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $location == 'sidebar' ):\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction post( $item, $comment, $editorName, $app, $type, $class='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n<div id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap' data-controller='core.front.core.comment' data-commentApp='\nCONTENT;\n$return .= htmlspecialchars( $app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentType='\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-commentID=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-quoteData='\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( array('userid' => $comment->author()->member_id, 'username' => $comment->author()->name, 'timestamp' => $comment->mapped('date'), 'contentapp' => $comment::$application, 'contenttype' => $type, 'contentid' => $item->tid, 'contentclass' => $class, 'contentcommentid' => $comment->$idField) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsComment_content ipsType_medium'>\n\n\t<div class='ipsComment_meta ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:between ipsFlex-fd:row-reverse'>\n\t\t<div class='ipsType_light ipsType_reset ipsType_blendLinks ipsComment_toolWrap'>\n\t\t\t<div class='ipsResponsive_hidePhone ipsComment_badges'>\n\t\t\t\t<ul class='ipsList_reset ipsFlex ipsFlex-jc:end ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1'>\n\t\t\t\t\t\nCONTENT;\n\nif ( ! $comment->isFirst() and $comment->author()->member_id AND $comment->author()->member_id == $item->author()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><strong class=\"ipsBadge ipsBadge_large ipsComment_authorBadge\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'author', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_highlightedGroup'>\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $comment->author()->member_group_id )->name;\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( ( $comment->item()->isSolved() and $comment->item()->mapped('solved_comment_id') == $comment->pid ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_positive ipsBadge_reverse'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_solved_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->isFeatured() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_featured_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<ul class='ipsList_reset ipsComment_tools'>\n\t\t\t\t<li>\n\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsComment_ellipsis' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'><i class='fa fa-ellipsis-h'><\/i><\/a>\n\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canReportOrRevoke() === TRUE ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('report'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id or \\IPS\\Helpers\\Form\\Captcha::supportsModal() ):\n$return .= <<<CONTENT\ndata-ipsDialog data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_submit_success', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-action='reportComment' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'report', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first')  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-content='#elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" id='elSharePost_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' rel=\"nofollow\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-content='#elShareComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share_this_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" id='elSharePost_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role='shareComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'share', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                        \nCONTENT;\n\nif ( $comment->canRecognize() === TRUE ):\n$return .= <<<CONTENT\n\n                        <li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->url()->setQueryString( array( 'do' => 'recognize', 'content_class' => \\get_class( $comment ), 'content_id' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size='medium' data-ipsDialog-flashMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recognize_submit_success', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recognize_author', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recognize_author', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n                        \nCONTENT;\n\nelseif ( $comment->canRemoveRecognize() ):\n$return .= <<<CONTENT\n\n                        <li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->url()->setQueryString( array( 'do' => 'unrecognize', 'content_class' => \\get_class( $comment ), 'content_id' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recognize_author_remove_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recognize_author_remove', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n                        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() || ( !$comment->mapped('first') and ( $comment->canPromoteToSocialMedia() || $comment->item()->canSolve() || $comment->canDelete() || $comment->canHide() || $comment->canUnhide() || $comment->canSplit() || $item->canFeatureComment() || $item->canUnfeatureComment() || ( $comment->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_sep'><hr><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('restore')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('restore')->csrf()->setQueryString( 'restoreAsHidden', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setQueryString( 'immediately', 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm data-confirmSubMessage='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->hidden() and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() and $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->isFeatured() AND $item->canUnfeatureComment() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unfeature')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"unrecommendComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unrecommend_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->isFeatured() AND $item->canFeatureComment() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('feature')->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommend_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsDialog-remoteSubmit data-ipsDialog-size='medium' data-action=\"recommendComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recommend_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( ( ! $comment->mapped('first') and $comment->canPromoteToSocialMedia() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class='ipsMenu_item'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->promoteLink( $comment );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\count( $item->commentMultimodActions() ) and !$comment->mapped('first') ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li><span class='ipsCustomInput'>\n\t\t\t\t\t<input type=\"checkbox\" name=\"multimod[\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"1\" data-role=\"moderation\" data-actions=\"\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\nsplit merge\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->hidden() === -1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\nunhide\nCONTENT;\n\nelseif ( $comment->hidden() === 1 AND $comment->canUnhide() ):\n$return .= <<<CONTENT\napprove\nCONTENT;\n\nelseif ( $comment->canHide() ):\n$return .= <<<CONTENT\nhide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\ndelete\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-state='\nCONTENT;\n\nif ( $comment->tableStates() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $comment->tableStates(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<span><\/span>\n\t\t\t\t<\/span><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\n\t\t<div class='ipsType_reset ipsResponsive_hidePhone'>\n\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' rel=\"nofollow\" class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\nCONTENT;\n\nif ( $comment->ip_address and \\IPS\\Member::loggedIn()->modPermission('can_use_ip_tools') and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t&middot; <a class='ipsType_blendLinks ipsType_light ipsType_noUnderline ipsType_noBreak' href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=ip_tools&ip=$comment->ip_address\", null, \"modcp_ip_tools\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-menuID='\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_ip_menu'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_short', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-down'><\/i><\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<span class='ipsResponsive_hidePhone'>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edited_lc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() AND $comment->hidden() != -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; \nCONTENT;\n$return .= htmlspecialchars( $comment->deletedBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/span>\n\t\t<\/div>\n\t<\/div>\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $comment->warning ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentWarned( $comment );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n    \nCONTENT;\n\nif ( $comment->showRecognized() ):\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentRecognized( $comment );\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<div class='cPost_contentWrap'>\n\t\t\nCONTENT;\n\nif ( $comment->hidden() !== 0 ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsResponsive_showPhone ipsResponsive_block ipsSpacer_bottom'>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() AND $comment->hidden() != -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $comment->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( $comment->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $comment->deletedBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<div data-role='commentContent' class='ipsType_normal ipsType_richText ipsPadding_bottom ipsContained' data-controller='core.front.core.lightboxedImages'>\n\t\t\t{$comment->content()}\n\n\t\t\t\nCONTENT;\n\nif ( $comment->editLine() ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$comment->editLine()}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( ( \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled and $comment->hasReactionBar() ) || ( $comment->hidden() === 1 && ( $comment->canUnhide() || $comment->canDelete() ) ) || ( $comment->hidden() === 0 and $item->canComment() and $editorName ) || $comment->item()->canSolve()  ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsItemControls'>\n\t\t\t\t\nCONTENT;\n\nif ( !( $comment->hidden() === 1 && ( $comment->canUnhide() || $comment->canDelete() ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $comment, 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reputation( $comment );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class='ipsComment_controls ipsClearfix ipsItemControls_left' data-role=\"commentControls\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 1 && ( $comment->canUnhide() || $comment->canDelete() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('unhide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_verySmall ipsButton_positive' data-action='approveComment'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('delete')->csrf()->setPage('page',\\IPS\\Request::i()->page), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='deleteComment' data-updateOnDelete=\"#commentCount\" class='ipsButton ipsButton_verySmall ipsButton_negative'><i class='fa fa-times'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() || $comment->canSplit() || $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a href='#elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_moderator_menu' id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_moderator' data-ipsMenu data-ipsMenu-appendTo='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_wrap'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderator_tools', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n &nbsp;<i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t\t\t<ul id='elControls_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_moderator_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->mapped('first') and $comment->item()->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('edit'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='editComment'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->canSplit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('split'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='splitComment' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( $item::$title )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split_to_new', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'split', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment instanceof \\IPS\\Content\\Hideable and $comment->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->url('hide')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->hidden() === 0 and $item->canComment() and $editorName ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t\t\t<button class='ipsButton ipsButton_light ipsButton_verySmall ipsButton_narrow cMultiQuote ipsHide' data-action='multiQuoteComment' data-ipsTooltip data-ipsQuote-multiQuote data-mqId='mq\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'multiquote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-plus'><\/i><\/button>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t<li data-ipsQuote-editor='\nCONTENT;\n$return .= htmlspecialchars( $editorName, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsQuote-target='#comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsJS_show'>\n\t\t\t\t\t\t\t\t<a href='#' data-action='quoteComment' data-ipsQuote-singleQuote>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( ( $comment->item()->isSolved() and $comment->item()->mapped('solved_comment_id') == $comment->pid ) AND $comment->item()->canSolve() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'unsolve', 'answer' => $comment->pid ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"unsolveComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unsolve_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $comment->item()->canSolve() AND ! $comment->item()->isSolved() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'solve', 'answer' => $comment->pid ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"solveComment\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solve_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsHide' data-role='commentLoading'>\n\t\t\t\t\t\t<span class='ipsLoading ipsLoading_tiny ipsLoading_noAnim'><\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\nCONTENT;\n\nif ( trim( $comment->author()->signature ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->signature( $comment->author() );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\n\t\nCONTENT;\n\nif ( $comment->ip_address and \\IPS\\Member::loggedIn()->modPermission('can_use_ip_tools') and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsHide ipsPadding ipsMenu ipsMenu_veryWide' id='\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_ip_menu'>\n\t\t\t<h5 class='ipsType_normal ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_address', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h5>\n\t\t\t<input type='text' autofocus class='ipsField_fullWidth ipsMargin_vertical:half' value='\nCONTENT;\n$return .= htmlspecialchars( $comment->ip_address, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=ip_tools&ip=$comment->ip_address\", null, \"modcp_ip_tools\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'more_about_ip_address', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i><\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->sharemenu( $comment );\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction postContainer( $item, $comment, $votes=array(), $otherClasses='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$itemClassSafe = str_replace( '\\\\', '_', mb_substr( $comment::$itemClass, 4 ) );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\n\n\t<div class='ipsComment ipsComment_ignored ipsType_light' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreCommentID='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ignoreUserID='\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ignoring_content', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n <a href='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu data-ipsMenu-menuID='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu' data-ipsMenu-appendTo='#elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action=\"ignoreOptions\" title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_post_ignore_options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'options', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a>\n\t\t<ul class='ipsMenu ipsHide' id='elIgnoreComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu'>\n\t\t\t<li class='ipsMenu_item ipsJS_show' data-ipsMenuValue='showPost'><a href='#'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'show_this_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_sep ipsJS_show'><hr><\/li>\n\t\t\t<li class='ipsMenu_item' data-ipsMenuValue='stopIgnoring'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore&do=remove&id={$comment->author()->member_id}\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stop_ignoring_posts_by', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li class='ipsMenu_item'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ignore\", null, \"ignore\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'change_ignore_preferences', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<a id='comment-\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/a>\n<article \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\ndata-memberGroup=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->author()->member_group_id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n id='elComment_\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='cPost ipsBox ipsResponsive_pull \nCONTENT;\n\nif ( $otherClasses ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $otherClasses, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment \nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight ) OR $comment->isFeatured() ):\n$return .= <<<CONTENT\nipsComment_popular\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsComment_parent ipsClearfix ipsClear ipsColumns ipsColumns_noSpacing ipsColumns_collapsePhone \nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\nipsComment_highlighted\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->isIgnored() ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $comment->hidden() OR $item->hidden() === -2 ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( ( $comment->item()->isSolved() and $comment->item()->mapped('solved_comment_id') == $comment->pid ) ):\n$return .= <<<CONTENT\nipsComment_solved\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( $item->isQuestion() and !$comment->new_topic ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->postRating( $item, $comment, $votes );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() || ( $comment->item()->isSolved() and $comment->item()->mapped('solved_comment_id') == $comment->pid ) || $comment->isFeatured() || ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight )  ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsResponsive_showPhone ipsComment_badges'>\n\t\t\t<ul class='ipsList_reset ipsFlex ipsFlex-fw:wrap ipsGap:2 ipsGap_row:1'>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->author()->hasHighlightedReplies() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_highlightedGroup'>\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $comment->author()->member_group_id )->name;\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( ( $comment->item()->isSolved() and $comment->item()->mapped('solved_comment_id') == $comment->pid ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_positive ipsBadge_reverse'><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_solved_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->isFeatured() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_featured_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( ( \\IPS\\Settings::i()->reputation_enabled and \\IPS\\Settings::i()->reputation_highlight and $comment->reactionCount() >= \\IPS\\Settings::i()->reputation_highlight )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><strong class='ipsBadge ipsBadge_large ipsBadge_popular'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_a_popular_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t<div class='cAuthorPane_mobile ipsResponsive_showPhone'>\n\t\t<div class='cAuthorPane_photo'>\n\t\t\t<div class='cAuthorPane_photoWrap'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'large', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $comment->author()->modShowBadge() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cAuthorPane_badge cAuthorPane_badge--moderator\" data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_is_moderator', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"><\/span>\n\t\t\t\t\nCONTENT;\n\nelseif ( $comment->author()->joinedRecently() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"cAuthorPane_badge cAuthorPane_badge--new\" data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_is_new_badge', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"><\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !$comment->isAnonymous() and $comment->author()->canHaveAchievements() and \\IPS\\core\\Achievements\\Rank::show() and $rank = $comment->author()->rank() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$comment->author()->member_id}&do=badges\", null, \"profile_badges\", array( $comment->author()->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\">\n\t\t\t\t\t\t{$rank->html( 'cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px' )}\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='cAuthorPane_content'>\n\t\t\t<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_break ipsType_blendLinks ipsFlex ipsFlex-ai:center'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef(), TRUE, $comment->isAnonymous() );\n$return .= <<<CONTENT\n\n\t\t\t<\/h3>\n\t\t\t<div class='ipsType_light ipsType_reset'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $comment->$idField ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' rel=\"nofollow\" class='ipsType_blendLinks'>{$comment->dateLine()}<\/a>\n\t\t\t\t\nCONTENT;\n\nif ( $comment->ip_address and \\IPS\\Member::loggedIn()->modPermission('can_use_ip_tools') and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'modcp' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&middot; <a class='ipsType_blendLinks ipsType_light ipsType_noUnderline ipsType_noBreak' href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=modcp&controller=modcp&tab=ip_tools&ip=$comment->ip_address\", null, \"modcp_ip_tools\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsMenu data-ipsMenu-menuID='\nCONTENT;\n$return .= htmlspecialchars( $comment->$idField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_ip_menu'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_short', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-down'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t<aside class='ipsComment_author cAuthorPane ipsColumn ipsColumn_medium ipsResponsive_hidePhone'>\n\t\t<h3 class='ipsType_sectionHead cAuthorPane_author ipsType_blendLinks ipsType_break'><strong>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $comment->author(), $comment->warningRef(), FALSE, $comment->isAnonymous() );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\nCONTENT;\n\nif ( $comment->isAnonymous() and \\IPS\\Member::loggedIn()->modPermission('can_view_anonymous_posters') ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a data-ipsHover data-ipsHover-width=\"370\" data-ipsHover-onClick href=\"\nCONTENT;\n\nif ( $comment->isFirst() ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $comment->item()->url( 'reveal' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $comment->url( 'reveal' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" rel=\"nofollow\"><span class=\"cAuthorPane_badge cAuthorPane_badge--anon\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'post_anonymously_reveal', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><\/span><\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/h3>\n\t\t<ul class='cAuthorPane_info ipsList_reset'>\n\t\t\t<li data-role='photo' class='cAuthorPane_photo'>\n\t\t\t\t<div class='cAuthorPane_photoWrap'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $comment->author(), 'large', $comment->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $comment->author()->modShowBadge() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"cAuthorPane_badge cAuthorPane_badge--moderator\" data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_is_moderator', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $comment->author()->joinedRecently() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class=\"cAuthorPane_badge cAuthorPane_badge--new\" data-ipsTooltip title=\"\nCONTENT;\n\n$sprintf = array($comment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_is_new_badge', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( !$comment->isAnonymous() and $comment->author()->canHaveAchievements() and \\IPS\\core\\Achievements\\Rank::show() and $rank = $comment->author()->rank() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$rank->html( 'cAuthorPane_badge cAuthorPane_badge--rank ipsOutline ipsOutline:2px' )}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nif ( !$comment->isAnonymous() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li data-role='group'>\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $comment->author()->member_group_id )->formattedName;\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member\\Group::load( $comment->author()->member_group_id )->g_icon  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li data-role='group-icon'><img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Theme\", $comment->author()->group['g_icon'] )->url;\n$return .= <<<CONTENT\n' alt='' class='cAuthorGroupIcon'><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $comment->author()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li data-role='stats' class='ipsMargin_top'>\n\t\t\t\t\t<ul class=\"ipsList_reset ipsType_light ipsFlex ipsFlex-ai:center ipsFlex-jc:center ipsGap_row:2 cAuthorPane_stats\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$comment->author()->member_id}&do=content\", null, \"profile_content\", array( $comment->author()->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" title=\"\nCONTENT;\n\n$pluralize = array( $comment->author()->member_posts ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_post_count', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class=\"ipsType_blendLinks\">\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<i class=\"fa fa-comment\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumberShort( $comment->author()->member_posts );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $comment->author_solved_count ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$comment->author()->member_id}&do=solutions\", null, \"profile_solutions\", array( $comment->author()->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' rel=\"nofollow\" title=\"\nCONTENT;\n\n$pluralize = array( $comment->author_solved_count ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solved_badge_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsType_blendLinks'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\n\t\t\t\t\t\t\t\t\t   <i class='fa fa-check-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $comment->author_solved_count );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members', 'front' ) )  ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $comment->author()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->customFieldsDisplay( $comment->author() );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/aside>\n\t<div class='ipsColumn ipsColumn_fluid ipsMargin:none'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->post( $item, $comment, $item::$formLangPrefix . 'comment', $item::$application, $item::$module, $itemClassSafe );\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/article>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction postRating( $item, $comment, $votes=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$idField = $comment::$databaseColumnId;\n$return .= <<<CONTENT\n\n<div class='cRatingColumn ipsClearfix \nCONTENT;\n\nif ( $comment->post_bwoptions['best_answer'] ):\n$return .= <<<CONTENT\ncRatingColumn_on\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsAreaBackground_light\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === 1 ):\n$return .= <<<CONTENT\ncRatingColumn_up\nCONTENT;\n\nelseif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === -1 ):\n$return .= <<<CONTENT\ncRatingColumn_down\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsColumn ipsColumn_narrow ipsType_center' data-controller='forums.front.topic.answers'>\n\t\n\t<ul class='ipsList_reset cPostRating_controls'>\n\t\nCONTENT;\n\nif ( !$item->isArchived()  ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $comment->post_bwoptions['best_answer'] or $item->canSetBestAnswer() ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='cPostRating_bestAnswer'>\n\t\t\t\t\nCONTENT;\n\nif ( $item->canSetBestAnswer() and !$comment->post_bwoptions['best_answer'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'bestAnswer', 'answer' => $comment->pid ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'set_as_best_answer', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='cBestAnswerIndicator cBestAnswerIndicator_off' data-ipsTooltip><i class='fa fa-check'><\/i><\/a>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $item->canSetBestAnswer() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->csrf()->setQueryString( array( 'do' => 'unsetBestAnswer', 'answer' => $comment->pid ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unset_as_best_answer', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='cBestAnswerIndicator' data-ipsTooltip><i class='fa fa-check'><\/i><\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<strong class='cBestAnswerIndicator' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'best_answer_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-check'><\/i><\/strong>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\t\nCONTENT;\n\nif ( $comment->canVote() ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='cPostRating_up'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->setQueryString( array( 'do' => 'rateAnswer', 'answer' => $comment->pid, 'rating' => 1 ) )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='cAnswerRate cAnswerRate_up \nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === 1 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === 1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_your_vote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'vote_answer_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-angle-up'><\/i><\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<li class='cPostRating_up'>\n\t\t\t\t<span class='cAnswerRate cAnswerRate_up cAnswerRate_noPermission' \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\ndata-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_rate_answer', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class='fa fa-angle-up'><\/i><\/span>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t<li class='cPostRating_count'>\n\t\t\t\t<span title=\"\nCONTENT;\n\n$pluralize = array( $comment->post_field_int ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'votes_no_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\" data-role=\"voteCount\" data-voteCount=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->post_field_int, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='cAnswerRating \nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === 1 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelseif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === -1 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $comment->post_field_int, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/li>\n\n\t\t\nCONTENT;\n\nif ( $comment->canVote() && \\IPS\\Settings::i()->forums_answers_downvote ):\n$return .= <<<CONTENT\n\n\t\t\t<li  class='cPostRating_down'>\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->setQueryString( array( 'do' => 'rateAnswer', 'answer' => $comment->pid, 'rating' => -1 ) )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='cAnswerRate cAnswerRate_down \nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === -1 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === -1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_your_vote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'vote_answer_down', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-angle-down'><\/i><\/a>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->forums_answers_downvote ):\n$return .= <<<CONTENT\n\n\t\t\t<li  class='cPostRating_down'>\n\t\t\t\t<span class='cAnswerRate cAnswerRate_down cAnswerRate_noPermission' \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\ndata-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_rate_answer', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class='fa fa-angle-down'><\/i><\/span>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( isset($comment->post_field_int)  ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='cPostRating_count'>\n\t\t\t\t<span title=\"\nCONTENT;\n\n$pluralize = array( $comment->post_field_int ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'votes_no_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\" data-role=\"voteCount\" data-voteCount=\"\nCONTENT;\n$return .= htmlspecialchars( $comment->post_field_int, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='cAnswerRating \nCONTENT;\n\nif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === 1 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelseif ( isset( $votes[ $comment->$idField ] ) && $votes[ $comment->$idField ] === -1 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $comment->post_field_int, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction topic( $topic, $comments, $question=NULL, $votes=array(), $nextUnread=NULL, $pagination=NULL, $topicVotes=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $club = $topic->container()->club() ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->clubs and \\IPS\\Settings::i()->clubs_header == 'full' ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"clubs\", \"core\" )->header( $club, $topic->container() );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div id=\"elClubContainer\">\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsPageHeader ipsResponsive_pull ipsBox ipsPadding sm:ipsPadding:half ipsMargin_bottom\">\n\t\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsFlex ipsFlex-ai:stretch ipsFlex-jc:center\">\n\t\t\t<ul class=\"ipsList_reset cRatingColumn cRatingColumn_question ipsType_center ipsMargin_right ipsFlex-flex:00 ipsBorder_right\">\n\t\t\t\t\nCONTENT;\n\nif ( $topic->canVote() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'rateQuestion', 'rating' => 1 ) )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"cAnswerRate cAnswerRate_up \nCONTENT;\n\nif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === 1 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\nif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === 1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_your_vote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'vote_question_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-ipstooltip><i class=\"fa fa-angle-up\"><\/i><\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span class=\"cAnswerRate cAnswerRate_up cAnswerRate_noPermission\" \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\ndata-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_rate_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class=\"fa fa-angle-up\"><\/i><\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t<li><span data-role=\"voteCount\" data-votecount=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\intval( $topic->question_rating ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"cAnswerRating \nCONTENT;\n\nif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === 1 ):\n$return .= <<<CONTENT\nipsType_positive\nCONTENT;\n\nelseif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === -1 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= htmlspecialchars( \\intval( $topic->question_rating ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span><\/li>\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->canVote() && \\IPS\\Settings::i()->forums_questions_downvote ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'rateQuestion', 'rating' => -1 ) )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"cAnswerRate cAnswerRate_down \nCONTENT;\n\nif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === -1 ):\n$return .= <<<CONTENT\nipsType_negative\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\nif ( isset( $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] ) && $topicVotes[ \\IPS\\Member::loggedIn()->member_id ] === -1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_your_vote', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'vote_question_down', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-ipstooltip><i class=\"fa fa-angle-down\"><\/i><\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->forums_questions_downvote ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span class=\"cAnswerRate cAnswerRate_down cAnswerRate_noPermission\" \nCONTENT;\n\nif ( !\\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\ndata-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_rate_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n><i class=\"fa fa-angle-down\"><\/i><\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\t<div class=\"ipsFlex-flex:11\">\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class=\"ipsFlex ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:4\">\n\t\t<div class=\"ipsFlex-flex:11\">\n\t\t\t<h1 class=\"ipsType_pageTitle ipsContained_container\">\n\t\t\t\t\nCONTENT;\n\nif ( $topic->mapped('pinned') || $topic->mapped('featured') || $topic->hidden() === -1 || $topic->hidden() === 1 || $topic->hidden() === -2 || $topic->isSolved() || ( $topic->canToggleItemModeration() and $topic->itemModerationEnabled() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_warning\" data-ipstooltip title=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-eye-slash\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $topic->hidden() === -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_warning\" data-ipstooltip title=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->deletedBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-trash\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $topic->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_warning\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-warning\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nelseif ( $topic->canToggleItemModeration() and $topic->itemModerationEnabled() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_warning\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_moderation_enabled', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-user-times\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->mapped('pinned') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_positive\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pinned', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-thumb-tack\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->mapped('featured') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_positive\" data-ipstooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-star\"><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->prefix() OR ( $topic->canEdit() AND $topic::canTag( NULL, $topic->container() ) AND $topic::canPrefix( NULL, $topic->container() ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span \nCONTENT;\n\nif ( !$topic->prefix() ):\n$return .= <<<CONTENT\nclass=\"ipsHide\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( ( $topic->canEdit() AND $topic::canTag( NULL, $topic->container() ) AND $topic::canPrefix( NULL, $topic->container() ) ) ):\n$return .= <<<CONTENT\ndata-editableprefix\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->prefix( $topic->prefix( TRUE ), $topic->prefix() );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->canEdit() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class=\"ipsType_break ipsContained\" data-controller=\"core.front.core.moderation\">\n\t\t\t\t\t\t<span data-role=\"editableTitle\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'click_hold_edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $topic->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class=\"ipsType_break ipsContained\">\n\t\t\t\t\t\t<span>\nCONTENT;\n$return .= htmlspecialchars( $topic->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/h1>\n\t\t\t\nCONTENT;\n\nif ( $topic->locked() && $topic->topic_open_time && $topic->topic_open_time > time() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_reset ipsType_medium\"><strong><i class=\"fa fa-clock-o\"><\/i> \nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $topic->topic_open_time )->html(), \\IPS\\DateTime::ts( $topic->topic_open_time )->localeTime( FALSE )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_unlocks_at', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/strong><\/p>\n\t\t\t\nCONTENT;\n\nelseif ( !$topic->locked() && $topic->topic_close_time && $topic->topic_close_time > time() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_reset ipsType_medium\"><strong><i class=\"fa fa-clock-o\"><\/i> \nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $topic->topic_close_time )->html(), \\IPS\\DateTime::ts( $topic->topic_close_time )->localeTime( FALSE )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_locks_at', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/strong><\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\count( $topic->tags() ) OR ( $topic->canEdit() AND $topic::canTag( NULL, $topic->container() ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tags( $topic->tags(), FALSE, FALSE, ( $topic->canEdit() AND $topic::canTag( NULL, $topic->container() ) ) ? $topic->url() : NULL );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( $topic->container()->forum_allow_rating ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsFlex-flex:00 ipsType_light\">\n\t\t\t\t\nCONTENT;\n\nif ( $topic->canRate() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_reset ipsType_small\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'rate_this_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'rate_this_topic', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t{$topic->rating()}\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<hr class=\"ipsHr\">\n\t<div class=\"ipsPageHeader__meta ipsFlex ipsFlex-jc:between ipsFlex-ai:center ipsFlex-fw:wrap ipsGap:3\">\n\t\t<div class=\"ipsFlex-flex:11\">\n\t\t\t<div class=\"ipsPhotoPanel ipsPhotoPanel_mini ipsPhotoPanel_notPhone ipsClearfix\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $topic->author(), 'mini', $topic->warningRef() );\n$return .= <<<CONTENT\n\n\t\t\t\t<div>\n\t\t\t\t\t<p class=\"ipsType_reset ipsType_blendLinks\">\n\t\t\t\t\t\t<span class=\"ipsType_normal\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$htmlsprintf = array($topic->author()->link( $topic->warningRef(), NULL, $topic->isAnonymous() )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ask_byline_no_date', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n,<\/strong><br>\n\t\t\t\t\t\t\t<span class=\"ipsType_light\">\nCONTENT;\n\n$val = ( $topic->start_date instanceof \\IPS\\DateTime ) ? $topic->start_date : \\IPS\\DateTime::ts( $topic->start_date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$htmlsprintf = array($topic->author()->link( $topic->warningRef(), NULL, $topic->isAnonymous() )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_itemprop', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t<span class=\"ipsType_light\">\nCONTENT;\n\n$val = ( $topic->start_date instanceof \\IPS\\DateTime ) ? $topic->start_date : \\IPS\\DateTime::ts( $topic->start_date );$return .= $val->html();\n$return .= <<<CONTENT\n \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->container()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">{$topic->container()->_formattedTitle}<\/a><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/p>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( !$topic->isArchived() and !$topic->container()->password ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsFlex-flex:01 ipsResponsive_hidePhone\">\n\t\t\t\t<div class=\"ipsFlex ipsFlex-ai:center ipsFlex-jc:center ipsGap:3 ipsGap_row:0\">\n\t\t\t\t\t\nCONTENT;\n\nif ( !$topic->container()->disable_sharelinks ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"sharelinks\", \"core\" )->shareButton( $topic );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->promote( $topic );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->follow( 'forums', 'topic', $topic->tid, $topic->followersCount() );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\t\n\t<\/div>\n\t\nCONTENT;\n\nif ( $topic->isSolved() ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $solvedComment = $topic->getSolution() AND ( $solvedComment->hidden() == 0 OR ( \\in_array( $solvedComment->hidden(), array( 1, -1 ) ) AND $solvedComment->canUnhide() ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsBox ipsBox--child ipsComment ipsComment_solved ipsMargin:none ipsMargin_top ipsPadding:half\">\n\t\t\t\t<div class=\"ipsFlex ipsFlex-ai:center sm:ipsFlex-fd:column ipsGap:3\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'findComment', 'comment' => $topic->topic_answered_pid )), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class=\"ipsButton ipsButton_verySmall ipsButton_positive sm:ipsFlex-as:stretch\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solved_and_go', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<span class=\"ipsFlex-flex:10 ipsType_positive ipsType_normal\">\n\t\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($solvedComment->author()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solved_byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n, \nCONTENT;\n\n$val = ( $solvedComment->mapped('date') instanceof \\IPS\\DateTime ) ? $solvedComment->mapped('date') : \\IPS\\DateTime::ts( $solvedComment->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/span>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->contentItemMessages( $topic->getMessages(), $topic );\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $topic->hidden() === 1 and $topic->canUnhide() ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_warning ipsSpacer_top\">\n\t\t<p class=\"ipsType_reset\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_pending_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t<ul class=\"ipsList_inline ipsSpacer_top\">\n\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_positive ipsButton_verySmall\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve_title_topic', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-check\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nif ( $topic->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_delete_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_negative ipsButton_verySmall\"><i class=\"fa fa-times\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsClearfix\">\n\t<ul class=\"ipsToolList ipsToolList_horizontal ipsClearfix ipsSpacer_both \nCONTENT;\n\nif ( !$topic->canComment() and !( $topic->canPin() or $topic->canUnpin() or $topic->canFeature() or $topic->canUnfeature() or $topic->canHide() or $topic->canUnhide() or $topic->canMove() or $topic->canLock() or $topic->canUnlock() or $topic->canDelete() or $topic->availableSavedActions() ) ):\n$return .= <<<CONTENT\nipsResponsive_hidePhone\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\nif ( $topic->canComment() ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"ipsToolList_primaryAction\">\n\t\t\t\t<span data-controller=\"forums.front.topic.reply\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->container()->forums_bitoptions['bw_enable_answers'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href=\"#replyForm\" rel=\"nofollow\" class=\"ipsButton \nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\nipsButton_link ipsButton_link--negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_important\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsButton_medium ipsButton_fullWidth\" data-action=\"replyToTopic\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'answer_this_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\n (\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'locked', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href=\"#replyForm\" rel=\"nofollow\" class=\"ipsButton \nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\nipsButton_link ipsButton_link--negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_important\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsButton_medium ipsButton_fullWidth\" data-action=\"replyToTopic\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reply_to_this_topic', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\n (\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'locked', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n)\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/span>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $topic->container()->can('add') ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"ipsResponsive_hidePhone\">\n\t\t\t\t\nCONTENT;\n\nif ( $topic->container()->forums_bitoptions['bw_enable_answers'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->container()->url()->setQueryString( 'do', 'add' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class=\"ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ask_a_question_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ask_a_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->container()->url()->setQueryString( 'do', 'add' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"nofollow\" class=\"ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'start_new_topic_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'start_new_topic', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( ( $topic->canPin() or $topic->canUnpin() or $topic->canFeature() or $topic->canUnfeature() or $topic->canHide() or $topic->canUnhide() or $topic->canMove() or $topic->canLock() or $topic->canUnlock() or $topic->canDelete() or $topic->availableSavedActions() or $topic->canMerge() or $topic->canUnarchive() or $topic->canRemoveArchiveExcludeFlag() or \\IPS\\Member::loggedIn()->modPermission('can_view_moderation_log') or $topic->canToggleItemModeration() ) or ( $topic->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href=\"#elTopicActions_menu\" id=\"elTopicActions\" class=\"ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth\" data-ipsmenu>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderator_actions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/a>\n\t\t\t\t<ul id=\"elTopicActions_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\nCONTENT;\n\nif ( $topic->hidden() != -2 and \\IPS\\Member::loggedIn()->modPermission( 'can_copy_topic_database' ) ):\n$return .= <<<CONTENT\n\r\n\t<li class=\"ipsMenu_item\">\r\n      \t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=cms&module=database&controller=topic&id=$topic->tid&_new=1\", \"front\", \"topic_copy\", array( $topic->title_seo ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-remoteverify=\"false\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copy_select_database', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copy_topic_to_database', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\r\n\t<\/li>\r\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') AND $topic->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restore' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restoreAsHidden' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete', 'immediate' => 1 ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canFeature() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'feature' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'feature', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnfeature() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unfeature' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unfeature', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canPin() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'pin' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnpin() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unpin' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unpin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canHide() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'moderate', 'action' => 'hide' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnhide() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nif ( $topic->hidden() === 1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canLock() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'lock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'lock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnlock() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unlock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canMove() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'move' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'move', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'move', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canMerge() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'merge' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnarchive() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'unarchive' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->unarchiveBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unarchive', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                        \nCONTENT;\n\nif ( $topic->canRemoveArchiveExcludeFlag() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'removeArchiveExclude' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_archive_exlude', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canDelete() ):\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canOnMessage( 'add' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'messageForm' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canToggleItemModeration() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'toggleItemModeration' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmmessage=\"\nCONTENT;\n\nif ( $topic->itemModerationEnabled() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'disable_topic_moderation_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'enable_topic_moderation_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nif ( $topic->itemModerationEnabled() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'disable_topic_moderation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'enable_topic_moderation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( !$topic->isArchived() and $topic->availableSavedActions() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $topic->availableSavedActions() as $action ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'savedAction', 'action' => $action->_id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n$return .= htmlspecialchars( $action->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_view_moderation_log') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'modLog' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\n\nCONTENT;\n\nif ( $poll = $topic->getPoll() ):\n$return .= <<<CONTENT\n\n<div class=\"ipsBox ipsResponsive_pull\">\n{$poll}\n<\/div>\n<br>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div id=\"comments\" data-controller=\"core.front.core.commentFeed,forums.front.topic.view, core.front.core.ignoredComments\" \nCONTENT;\n\nif ( \\IPS\\Settings::i()->auto_polling_enabled ):\n$return .= <<<CONTENT\ndata-autopoll\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-baseurl=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $topic->isLastPage() ):\n$return .= <<<CONTENT\ndata-lastpage\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-feedid=\"topic-\nCONTENT;\n$return .= htmlspecialchars( $topic->tid, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"cTopic ipsClear ipsSpacer_top\">\n\t\nCONTENT;\n\nif ( $topic->isQuestion() && $question ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsBox ipsResponsive_pull\">\n\t\t\t<h2 class=\"ipsType_sectionTitle ipsType_reset\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'question_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->postContainer( $topic, $question, $votes, 'cPostQuestion ipsBox--child sm:ipsPadding_horizontal:half' );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\n\t\t\nCONTENT;\n\nif ( ( $topic->showSummaryOnDesktop() === 'post' OR $topic->showSummaryOnMobile() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsSpacer_top\">\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->activity( $topic, 'post' );\n$return .= <<<CONTENT\n<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\n\t\t<div class=\"ipsSpacer_both\">\n\t\t\t<div class=\"ipsBox ipsResponsive_pull ipsMargin_bottom\">\n\t\t\t\t<h2 class=\"ipsType_sectionTitle ipsType_reset ipsHide\">\nCONTENT;\n\n$pluralize = array( ( $topic->posts ) ? $topic->posts - 1 : 0 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'answer_count', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t<div class=\"ipsPadding:half ipsClearfix\">\n\t\t\t\t\t<ul class=\"ipsPos_right ipsButtonRow ipsClearfix sm:ipsMargin_bottom:half\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( ( \\count( $topic->commentMultimodActions() ) && ( $topic->posts > 1 OR $topic->mapped('unapproved_comments') > 0 OR $topic->mapped('hidden_comments') > 0 ) ) || $pagination ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a class=\"ipsJS_show\" href=\"#elCheck_menu\" id=\"elCheck\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipstooltip data-ipsautocheck data-ipsautocheck-context=\"#elPostFeed\" data-ipsmenu data-ipsmenu-activeclass=\"ipsButtonRow_active\">\n\t\t\t\t\t\t\t\t<span class=\"cAutoCheckIcon ipsType_medium\"><i class=\"fa fa-square-o\"><\/i><\/span> <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t\t\t\t\t<span class=\"ipsNotificationCount\" data-role=\"autoCheckCount\">0<\/span>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t<ul class=\"ipsMenu ipsMenu_auto ipsMenu_withStem ipsHide\" id=\"elCheck_menu\">\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"all\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"none\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'none', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"hidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"unhidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"unapproved\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unapproved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id=\"elSortBy_answers\" \nCONTENT;\n\nif ( !isset( \\IPS\\Request::i()->sortby ) ):\n$return .= <<<CONTENT\nclass=\"ipsButtonRow_active\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sort_by_answers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( 'sortby', 'date' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id=\"elSortBy_date\" \nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->sortby ) and \\IPS\\Request::i()->sortby == 'date' ):\n$return .= <<<CONTENT\nclass=\"ipsButtonRow_active\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sort_by_date', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nif ( $pagination ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$pagination}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( ( \\count( $topic->commentMultimodActions() ) && ( $topic->posts > 1 OR $topic->mapped('unapproved_comments') > 0 OR $topic->mapped('hidden_comments') > 0 ) ) || $pagination ):\n$return .= <<<CONTENT\n\n\n\t\t\t\t<div class=\"ipsBox ipsResponsive_pull ipsPadding:half ipsClearfix ipsClear ipsMargin_bottom\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\count( $topic->commentMultimodActions() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<ul class=\"ipsButtonRow ipsPos_right ipsClearfix sm:ipsMargin_bottom:half\">\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<a class=\"ipsJS_show\" href=\"#elCheck_menu\" id=\"elCheck\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows_tooltip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipstooltip data-ipsautocheck data-ipsautocheck-context=\"#elPostFeed\" data-ipsmenu data-ipsmenu-activeclass=\"ipsButtonRow_active\">\n\t\t\t\t\t\t\t\t\t<span class=\"cAutoCheckIcon ipsType_medium\"><i class=\"fa fa-square-o\"><\/i><\/span> <i class=\"fa fa-caret-down\"><\/i>\n\t\t\t\t\t\t\t\t\t<span class=\"ipsNotificationCount\" data-role=\"autoCheckCount\">0<\/span>\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<ul class=\"ipsMenu ipsMenu_auto ipsMenu_withStem ipsHide\" id=\"elCheck_menu\">\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'select_rows', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"all\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"none\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'none', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"hidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"unhidden\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t\t<li class=\"ipsMenu_item\" data-ipsmenuvalue=\"unapproved\"><a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unapproved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $pagination ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$pagination}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->featuredComments( $topic->featuredComments(), $topic->url()->setQueryString( 'recommended', 'comments' ), 'recommended_posts', 'post_lc' );\n$return .= <<<CONTENT\n\n\t\n\t<div id=\"elPostFeed\" data-role=\"commentFeed\" data-controller=\"core.front.core.moderation\" \nCONTENT;\n\nif ( $topic->isQuestion() AND $topic->topic_answered_pid ):\n$return .= <<<CONTENT\n data-topicanswerid=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->topic_answered_pid, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( 'do', 'multimodComment' )->setPage('page', \\IPS\\Request::i()->page ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" data-ipspageaction data-role=\"moderationTools\">\n\t\t\t\nCONTENT;\n\n$postCount=0; $timeLastRead = $topic->timeLastRead(); $lined = FALSE;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\count( $comments ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $topic->generateCommentMetaData( $comments, \\IPS\\Settings::i()->forums_mod_actions_anon ) as $comment ):\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\nCONTENT;\n\nif ( (!$topic->isQuestion() and !$lined and $timeLastRead and $timeLastRead->getTimestamp() < $comment->mapped('date')) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $lined = TRUE and $postCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class=\"ipsUnreadBar\">\n\t\t\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_meta_unread', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\nCONTENT;\n\n$postCount++;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->postContainer( $topic, $comment, $votes, ( $topic->isQuestion() ) ? 'cPostQuestion' : '' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( !$topic->isQuestion() and ( isset( $comment->metaData['comment']['moderation'] ) OR isset( $comment->metaData['comment']['timeGap'] ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<ul class=\"ipsTopicMeta\">\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $comment->metaData['comment']['moderation'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $comment->metaData['comment']['moderation'] as $modAction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li class=\"ipsTopicMeta__item ipsTopicMeta__item--moderation\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"ipsTopicMeta__time ipsType_light\">\nCONTENT;\n\n$val = ( $modAction['row']['ctime'] instanceof \\IPS\\DateTime ) ? $modAction['row']['ctime'] : \\IPS\\DateTime::ts( $modAction['row']['ctime'] );$return .= $val->html(TRUE, TRUE);\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"ipsTopicMeta__action\">\nCONTENT;\n$return .= htmlspecialchars( $modAction['blurb'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $comment->metaData['comment']['timeGap'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class=\"ipsTopicMeta__item ipsTopicMeta__item--time\">\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $comment->metaData['comment']['timeGap']['blurb'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n...\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $postCount == 1 AND $advertisement = \\IPS\\core\\Advertisement::loadByLocation( 'ad_topic_view' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t{$advertisement}\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( ( ( ! $topic->isQuestion() and $postCount == 1 ) and ( $topic->showSummaryOnDesktop() === 'post' OR $topic->showSummaryOnMobile() ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"topics\", \"forums\" )->activity( $topic, 'post' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_center ipsType_light ipsType_large ipsPad\" data-role=\"noComments\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_answers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->commentMultimod( $topic );\n$return .= <<<CONTENT\n\n\t\t<\/form>\n\t<\/div>\n\n\t\nCONTENT;\n\nif ( $pagination ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsBox ipsPadding:half ipsMargin_top ipsClearfix ipsClear\">\n\t\t\t{$pagination}\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\nCONTENT;\n\nif ( $topic->isArchived() ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsMessage ipsMessage_general ipsSpacer_top\">\n\t\t\t<h4 class=\"ipsMessage_title\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_is_archived', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<p class=\"ipsType_reset\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_archived_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\nCONTENT;\n\nif ( $topic->commentForm() || $topic->locked() || \\IPS\\Member::loggedIn()->restrict_post || \\IPS\\Member::loggedIn()->members_bitoptions['unacknowledged_warnings'] || !\\IPS\\Member::loggedIn()->checkPostsPerDay() ):\n$return .= <<<CONTENT\n\n\t\t<a id=\"replyForm\"><\/a>\n\t\t<div data-role=\"replyArea\" class=\"cTopicPostArea ipsBox ipsResponsive_pull ipsPadding \nCONTENT;\n\nif ( !$topic->canComment() ):\n$return .= <<<CONTENT\ncTopicPostArea_noSize\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsSpacer_top\">\n\t\t\t\nCONTENT;\n\nif ( $topic->commentForm() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_reset ipsType_warning ipsComposeArea_warning ipsSpacer_bottom ipsSpacer_half\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_locked_can_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nelseif ( ( $topic->getPoll() and $topic->getPoll()->poll_only ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_reset ipsType_warning ipsComposeArea_warning ipsSpacer_bottom ipsSpacer_half\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'topic_poll_can_comment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t{$topic->commentForm()}\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $topic->locked() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'front' )->commentUnavailable( 'topic_locked_cannot_comment' );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Member::loggedIn()->restrict_post ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'front' )->commentUnavailable( 'restricted_cannot_comment', \\IPS\\Member::loggedIn()->warnings(5,NULL,'rpa'), \\IPS\\Member::loggedIn()->restrict_post );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Member::loggedIn()->members_bitoptions['unacknowledged_warnings'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'front' )->commentUnavailable( 'unacknowledged_warning_cannot_post', \\IPS\\Member::loggedIn()->warnings( 1, FALSE ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( !\\IPS\\Member::loggedIn()->checkPostsPerDay() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"forms\", \"core\", 'front' )->commentUnavailable( 'member_exceeded_posts_per_day' );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\nCONTENT;\n\nif ( !$topic->isArchived() and !$topic->container()->password ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsBox ipsPadding ipsResponsive_pull ipsResponsive_showPhone ipsMargin_top\">\n\t\t\t\nCONTENT;\n\nif ( !$topic->container()->disable_sharelinks ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsResponsive_noFloat ipsResponsive_block ipsMargin_bottom:half\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"sharelinks\", \"core\" )->shareButton( $topic, 'verySmall', 'light' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsResponsive_noFloat ipsResponsive_block\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->follow( 'forums', 'topic', $topic->tid, $topic->followersCount() );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( $topic->canPromoteToSocialMedia() and ( $topic instanceof \\IPS\\Content or $topic instanceof \\IPS\\Node\\Model ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsResponsive_noFloat ipsResponsive_block ipsMargin_top:half\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->promote( $topic );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\n\nCONTENT;\n\nif ( ( $topic->canPin() or $topic->canUnpin() or $topic->canFeature() or $topic->canUnfeature() or $topic->canHide() or $topic->canUnhide() or $topic->canMove() or $topic->canLock() or $topic->canUnlock() or $topic->canDelete() or $topic->availableSavedActions() or $topic->canMerge() or $topic->canUnarchive() or $topic->canRemoveArchiveExcludeFlag() or \\IPS\\Member::loggedIn()->modPermission('can_view_moderation_log') or $topic->canToggleItemModeration() ) or ( $topic->hidden() == -2 AND \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') ) ):\n$return .= <<<CONTENT\n\n\t<ul class=\"ipsToolList ipsToolList_horizontal ipsClearfix ipsSpacer_top ipsResponsive_hidePhone\">\n\t\t<li>\n\t\t\t<a href=\"#elTopicActionsBottom_menu\" id=\"elTopicActionsBottom\" class=\"ipsButton ipsButton_link ipsButton_link--light ipsButton_medium ipsButton_fullWidth\" data-ipsmenu>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderator_actions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/a>\n\t\t\t<ul id=\"elTopicActionsBottom_menu\" class=\"ipsMenu ipsMenu_auto ipsHide\">\nCONTENT;\n\nif ( $topic->hidden() != -2 and \\IPS\\Member::loggedIn()->modPermission( 'can_copy_topic_database' ) ):\n$return .= <<<CONTENT\n\r\n\t<li class=\"ipsMenu_item\">\r\n      \t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=cms&module=database&controller=topic&id=$topic->tid&_new=1\", \"front\", \"topic_copy\", array( $topic->title_seo ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-remoteverify=\"false\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copy_select_database', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'copy_topic_to_database', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\r\n\t<\/li>\r\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_manage_deleted_content') AND $topic->hidden() == -2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restore' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_visible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'restoreAsHidden' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'restore_as_hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete', 'immediate' => 1 ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete_immediately', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canFeature() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'feature' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'feature', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnfeature() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unfeature' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unfeature', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canPin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'pin' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnpin() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unpin' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unpin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canHide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'hide' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnhide() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unhide' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nif ( $topic->hidden() === 1 ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unhide', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canLock() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'lock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'lock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnlock() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'unlock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canMove() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'move' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'move', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'move', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canMerge() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'merge' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-size=\"narrow\" data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'merge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canUnarchive() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'unarchive' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmsubmessage=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->unarchiveBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unarchive', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canRemoveArchiveExcludeFlag() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'removeArchiveExclude' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'remove_archive_exlude', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'moderate', 'action' => 'delete' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canOnMessage( 'add' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'messageForm' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'add_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $topic->canToggleItemModeration() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'toggleItemModeration' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm data-confirmmessage=\"\nCONTENT;\n\nif ( $topic->itemModerationEnabled() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'disable_topic_moderation_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'enable_topic_moderation_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nif ( $topic->itemModerationEnabled() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'disable_topic_moderation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'enable_topic_moderation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( !$topic->isArchived() and $topic->availableSavedActions() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $topic->availableSavedActions() as $action ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->csrf()->setQueryString( array( 'do' => 'savedAction', 'action' => $action->_id ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n$return .= htmlspecialchars( $action->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('can_view_moderation_log') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'modLog' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsdialog data-ipsdialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/li>\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<div class=\"ipsPager ipsSpacer_top\">\n\t<div class=\"ipsPager_prev\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\forums\\Forum::isSimpleView( $topic->container() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=forums&module=forums&controller=index\", null, \"forums\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\nif ( $topic->isQuestion()  ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_qa_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" rel=\"parent\">\n\t\t\t\t<span class=\"ipsPager_type\">\nCONTENT;\n\nif ( $topic->isQuestion()  ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_qa_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->container()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\n$sprintf = array($topic->container()->metaTitle()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_to_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" rel=\"parent\">\n\t\t\t\t<span class=\"ipsPager_type\">\nCONTENT;\n\nif ( $topic->isQuestion()  ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_qa_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'go_back_to_forum', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( $nextUnread !== NULL ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsPager_next\">\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $topic->url()->setQueryString( array( 'do' => 'nextUnread' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title=\"\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_next_unread_question_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_next_unread_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t<span class=\"ipsPager_type\">\nCONTENT;\n\nif ( $topic->isQuestion() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_next_unread_question', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_next_unread', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\n\nCONTENT;\n\nif ( $topic->container()->club() ):\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
