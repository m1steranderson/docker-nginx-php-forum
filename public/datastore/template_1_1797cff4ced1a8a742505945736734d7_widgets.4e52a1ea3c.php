<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_front_widgets extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '9a31bead714a37eaad3463cd04f1621d';\n\tfunction achievements( $result, $title, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $title ):\n$return .= <<<CONTENT\n\n<h3 class=\"ipsType_reset ipsWidget_title\">\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='ipsPad_half ipsWidget_inner'>\n\t<ul class='ipsDataList ipsDataList_reducedSpacing'>\n\t\t\nCONTENT;\n\nforeach ( $result as $row ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\nCONTENT;\n\nif ( $row['type'] === 'badge' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsDataItem_icon ipsPos_top'>\n\t\t\t\t\t\t<div class='ipsPos_relative'>\n\t\t\t\t\t\t\t<div class='cAchievementsWidget__badge'>{$row['badge']->html('ipsDimension:5')}<\/div>\n\t\t\t\t\t\t\t<div class='cAchievementsWidget__photo'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $row['member'], 'tinier', '', 'ipsOutline' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsDataItem_main ipsPadding_left:half'>\n\t\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($row['member']->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_achievements_earned_badge', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<br>\t\t\t\t\t\t\n\t\t\t\t\t\t<strong \nCONTENT;\n\nif ( ! empty( $row['badge']->awardDescription ) ):\n$return .= <<<CONTENT\ntitle=\"\nCONTENT;\n$return .= htmlspecialchars( $row['badge']->awardDescription, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsTooltip\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $row['badge']->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t<span class=\"ipsType_light\">\nCONTENT;\n\n$val = ( $row['date'] instanceof \\IPS\\DateTime ) ? $row['date'] : \\IPS\\DateTime::ts( $row['date'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsDataItem_icon ipsPos_top'>\n\t\t\t\t\t\t<div class='ipsPos_relative'>\n\t\t\t\t\t\t\t<div class='cAchievementsWidget__badge'>{$row['rank']->html('ipsDimension:5')}<\/div>\n\t\t\t\t\t\t\t<div class='cAchievementsWidget__photo'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $row['member'], 'tinier', '', 'ipsOutline' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsDataItem_main ipsPadding_left:half'>\n\t\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($row['member']->link()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_achievements_earned_rank', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<br>\n\t\t\t\t\t\t<strong>\nCONTENT;\n$return .= htmlspecialchars( $row['rank']->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t<span class=\"ipsType_light\">\nCONTENT;\n\n$val = ( $row['date'] instanceof \\IPS\\DateTime ) ? $row['date'] : \\IPS\\DateTime::ts( $row['date'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction activeUsers( $members, $memberCount, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller='core.front.core.onlineUsersWidget'>\n    <h3 class='ipsType_reset ipsWidget_title'>\n        \nCONTENT;\n\nif ( \\IPS\\Dispatcher::i()->application->directory !== 'core' ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_activeUsers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_activeUsers_noApp', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nif ( $orientation == 'horizontal' ):\n$return .= <<<CONTENT\n\n        &nbsp;&nbsp;<span class='ipsType_light ipsType_unbold ipsType_medium' data-memberCount=\"\nCONTENT;\n$return .= htmlspecialchars( $memberCount, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$pluralize = array( $memberCount ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_user_online_info', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    <\/h3>\n    <div class='ipsWidget_inner ipsPad'>\n        <ul class='ipsList_inline ipsList_csv ipsList_noSpacing ipsType_normal'>\n            \nCONTENT;\n\nif ( $memberCount ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'members' ) )  ):\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nforeach ( $members as $row ):\n$return .= <<<CONTENT\n\n                    <li data-memberId=\"\nCONTENT;\n$return .= htmlspecialchars( $row['member_id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$row['member_id']}\", null, \"profile\", array( $row['seo_name'] ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsHover data-ipsHover-target='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$row['member_id']}&do=hovercard\", null, \"profile\", array( $row['seo_name'] ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $row['in_editor'] ):\n$return .= <<<CONTENT\ndata-ipsTooltip data-ipsTooltip-label=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_user_in_editor', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\ntitle=\"\nCONTENT;\n\n$sprintf = array($row['member_name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_user_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $row['in_editor'] ):\n$return .= <<<CONTENT\nclass='cActiveUserEditor'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $row['member_group'] )->formatName( $row['member_name'] );\n$return .= <<<CONTENT\n<\/a><\/li>\n                \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nforeach ( $members as $row ):\n$return .= <<<CONTENT\n\n                    <li data-memberId=\"\nCONTENT;\n$return .= htmlspecialchars( $row['member_id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\nif ( $row['in_editor'] ):\n$return .= <<<CONTENT\n<i class=\"fa fa-circle-o-notch fa-spin\" data-ipsTooltip data-ipsTooltip-label=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_user_in_editor', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><\/i>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                        \nCONTENT;\n\n$return .= \\IPS\\Member\\Group::load( $row['member_group'] )->formatName( $row['member_name'] );\n$return .= <<<CONTENT\n<\/li>\n                \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                <li class='ipsType_reset ipsType_medium ipsType_light' data-noneOnline>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'active_users_empty', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <\/ul>\n        \nCONTENT;\n\nif ( $memberCount > 60 && $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n            <p class='ipsType_medium ipsType_reset'>\n                <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=online&controller=online\", null, \"online\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$pluralize = array( $memberCount - 60 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'and_x_others', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/a>\n            <\/p>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    <\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction announcements( $announcements, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_announcements', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsWidget_inner'>\n\t\nCONTENT;\n\nif ( !empty( $announcements )  ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsList_reset ipsPad'>\n\t\t\t\nCONTENT;\n\nforeach ( $announcements as $announcement ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPhotoPanel ipsPhotoPanel_tiny cAnnouncement ipsClearfix'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $announcement->member_id ), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<h4 class='ipsType_large ipsType_reset'>\n\t\t\t\t\t\t\t\t<span class='ipsType_break ipsContained'>\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=announcement&id={$announcement->id}\", null, \"announcement\", array( $announcement->seo_title ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t<\/h4>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $announcement->start ):\n$return .= <<<CONTENT\n<span class='ipsType_light'>\nCONTENT;\n\n$val = ( $announcement->start instanceof \\IPS\\DateTime ) ? $announcement->start : \\IPS\\DateTime::ts( $announcement->start );$return .= (string) $val->localeDate();\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<h4 class='ipsType_large ipsType_reset'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=announcement&id={$announcement->id}\", null, \"announcement\", array( $announcement->seo_title ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $announcement->title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nif ( $announcement->start ):\n$return .= <<<CONTENT\n &nbsp;&nbsp;<span class='ipsType_light ipsType_medium ipsType_unbold'>\nCONTENT;\n\n$val = ( $announcement->start instanceof \\IPS\\DateTime ) ? $announcement->start : \\IPS\\DateTime::ts( $announcement->start );$return .= (string) $val->localeDate();\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/h4>\t\t\t\t\t\t\t\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class='ipsType_medium ipsType_textBlock ipsType_richText ipsContained' data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n6 lines\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n2 lines\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsTruncate-watch='false'>\n\t\t\t\t\t\t\t{$announcement->truncated( TRUE, NULL )}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsPad'>\n\t\t\t<p class='ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_announcements', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction blankWidget( $widget ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsWidgetBlank\">\n\t\nCONTENT;\n\n$val = \"{$widget->errorMessage}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction blockList( $availableBlocks ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( isset( $availableBlocks['plugin'] ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $availableBlocks['plugin'] as $pluginId => $blocks ):\n$return .= <<<CONTENT\n\n\t<h3 class='ipsToolbox_sectionTitle ipsCursor_pointer'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Plugin::load( $pluginId )->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\t<ul class='ipsList_reset'>\n\t\t\nCONTENT;\n\nforeach ( $blocks as $block ):\n$return .= <<<CONTENT\n\n\t\t\t<li data-blockTitle=\"\nCONTENT;\n$return .= htmlspecialchars( $block->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-blockID='plugin_\nCONTENT;\n$return .= htmlspecialchars( $block->plugin, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $block->key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $block->hasConfiguration() ):\n$return .= <<<CONTENT\ndata-blockConfig='true'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( $block->menuStyle) ):\n$return .= <<<CONTENT\ndata-menuStyle='\nCONTENT;\n$return .= htmlspecialchars( $block->menuStyle, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( !empty( $block->allowReuse) ):\n$return .= <<<CONTENT\ndata-allowReuse='true'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='ipsCursor_drag cSidebarManager_block'>\n\t\t\t\t<h4 class='ipsType_reset'>\nCONTENT;\n\n$val = \"block_{$block->key}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsType_small'>\nCONTENT;\n\n$val = \"block_{$block->key}_desc\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( isset( $availableBlocks['apps'] ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $availableBlocks['apps'] as $app => $blocks ):\n$return .= <<<CONTENT\n\n\t<h3 class='ipsToolbox_sectionTitle ipsCursor_pointer'>\nCONTENT;\n\n$val = \"__app_{$app}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t<ul class='ipsList_reset'>\n\t\t\nCONTENT;\n\nforeach ( $blocks as $block ):\n$return .= <<<CONTENT\n\n\t\t\t<li data-blockTitle=\"\nCONTENT;\n$return .= htmlspecialchars( $block->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-blockErrorMessage=\"\nCONTENT;\n\n$val = \"{$block->errorMessage}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'escape' => TRUE ) );\n$return .= <<<CONTENT\n\" data-blockID='app_\nCONTENT;\n$return .= htmlspecialchars( $block->app, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $block->key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $block->hasConfiguration() ):\n$return .= <<<CONTENT\ndata-blockConfig='true'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( $block->menuStyle) ):\n$return .= <<<CONTENT\ndata-menuStyle='\nCONTENT;\n$return .= htmlspecialchars( $block->menuStyle, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( !empty( $block->allowReuse) ):\n$return .= <<<CONTENT\ndata-allowReuse='true'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class='ipsCursor_drag cSidebarManager_block'>\n\t\t\t\t<h4 class='ipsType_reset'>\nCONTENT;\n\n$val = \"block_{$block->key}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t<p class='ipsType_reset ipsType_light ipsType_small'>\nCONTENT;\n\n$val = \"block_{$block->key}_desc\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\t<p class='ipsType_light ipsType_center ipsPad_half ipsHide'><em>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_app_widgets', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em><\/p>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction builderWrapper( $output, $config ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->do ) and \\IPS\\Request::i()->do == 'getBlock' ):\n$return .= <<<CONTENT\n\n<style type=\"text\/css\">\n\t\nCONTENT;\n\nif ( isset($config['custom']) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $config['custom'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( ! $config['border'] ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$block = \\IPS\\Request::i()->blockID;\n$return .= <<<CONTENT\n\n\t.ipsBox[data-blockid=\"\nCONTENT;\n$return .= htmlspecialchars( $block, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"] {\n\t\tborder: none;\n\t\tbox-shadow: none;\n\t}\n\t.ipsWidget[data-blockid=\"\nCONTENT;\n$return .= htmlspecialchars( $block, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"] {\n\t\tbackground: transparent !important;\n\t}\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/style>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! empty( $config['background_custom_image_overlay'] ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$padding = isset( $config['style']['padding'] ) ? $config['style']['padding'] : '';\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nunset( $config['style']['padding'] );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$style = implode( \" \", $config['style']);\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\n$style = implode( \" \", $config['style']);\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='\nCONTENT;\n$return .= htmlspecialchars( $config['class'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( ! empty($config['border']) ):\n$return .= <<<CONTENT\nipsBox\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif (  empty( $config['background_custom_image_overlay'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( ! empty($config['padding']) and $config['padding'] == 'half' ):\n$return .= <<<CONTENT\nipsPad_half\nCONTENT;\n\nelseif ( ! empty($config['padding']) and $config['padding'] == 'full' ):\n$return .= <<<CONTENT\nipsPad\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( ! empty($config['fontsize']) and $config['fontsize'] != 'custom' and $config['fontsize'] != 'inherit' ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $config['fontsize'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'\n\t style='\nCONTENT;\n\nif ( ! empty($config['style']) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $style, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( ! empty( $config['background_custom_image_overlay'] ) ):\n$return .= <<<CONTENT\n\n\t<div class='\nCONTENT;\n$return .= htmlspecialchars( $config['class'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_overlay' style=\"background-color: \nCONTENT;\n$return .= htmlspecialchars( $config['background_custom_image_overlay'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n; \nCONTENT;\n$return .= htmlspecialchars( $padding, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\n\t\t class=\"\nCONTENT;\n\nif ( ! empty($config['padding']) and $config['padding'] == 'half' ):\n$return .= <<<CONTENT\nipsPad_half\nCONTENT;\n\nelseif ( ! empty($config['padding']) and $config['padding'] == 'full' ):\n$return .= <<<CONTENT\nipsPad\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t{$output}\n\t\nCONTENT;\n\nif ( ! empty( $config['background_custom_image_overlay'] ) ):\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction clubs( $clubs, $title=NULL, $orientation=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $title ):\n$return .= <<<CONTENT\n\n\t<h3 class=\"ipsType_reset ipsWidget_title\">\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<section class=\"ipsWidget_inner ipsPad_half\">\n\t<ul class='ipsDataList ipsDataList_reducedSpacing'>\n\t\t\nCONTENT;\n\nforeach ( $clubs as $club ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDataItem ipsClearfix'>\n\t\t\t\t<div class='ipsDataItem_icon'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"clubs\", \"core\" )->clubIcon( $club, 'tiny', 'ipsPos_left' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t<h3 class='ipsType_sectionHead ipsType_large ipsContained_container'>\n\t\t\t\t\t\t<span class='ipsContained ipsType_break'><a href='\nCONTENT;\n$return .= htmlspecialchars( $club->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n$return .= htmlspecialchars( $club->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\t\t\t\t<\/h3>\n\t\t\t\t\t<p class='ipsType_reset ipsType_medium ipsType_light'>\n\t\t\t\t\t\t\nCONTENT;\n\n$val = \"club_{$club->type}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $club->type !== $club::TYPE_PUBLIC ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t&nbsp;&middot;&nbsp;\n\t\t\t\t\t\t\nCONTENT;\n\n$pluralize = array( $club->members ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'club_members_count', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/section>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction formTemplate( $widget, $id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar=NULL, $form=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->includeJS(  );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$visibilityFields = array( 'show_on_all_devices', 'devices_to_show', 'clubs_visibility');\n$return .= <<<CONTENT\n\n<form accept-charset='utf-8' class=\"ipsForm ipsForm_vertical\" action=\"\nCONTENT;\n$return .= htmlspecialchars( $action, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" \nCONTENT;\n\nif ( $uploadField ):\n$return .= <<<CONTENT\nenctype=\"multipart\/form-data\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nforeach ( $attributes as $k => $v ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n data-ipsForm>\n\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_submitted\" value=\"1\">\n\t\nCONTENT;\n\nforeach ( $hiddenValues as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $uploadField ):\n$return .= <<<CONTENT\n\n\t\t<input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $uploadField, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<input type=\"hidden\" name=\"plupload\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( md5( mt_rand() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsMenu_headerBar'>\n\t\t<h4 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'editBlockSettings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t<\/div>\n\n\t\nCONTENT;\n\n$hasSettings = FALSE;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( $collection as $inputName => $input ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\mb_substr( $inputName, 0, 12 ) != 'widget_adv__' and ! \\in_array( $inputName, $visibilityFields ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$hasSettings = TRUE; break 2;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\n\t<div class='ipsTabs ipsClearfix ipsJS_show' id='tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t<a href='#tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t<ul role='tablist'>\n\t\t\t\nCONTENT;\n\nif ( $hasSettings ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='#ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_settings_panel' id='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_settings' class=\"ipsTabs_item\" role=\"tab\" aria-selected=\"true\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'settings', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='#ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_visibility_panel' id='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_visibility' class=\"ipsTabs_item\" role=\"tab\" aria-selected=\"true\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'visibility', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nif ( ( \\in_array( 'IPS\\Widget\\Builder', class_implements( $widget ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<a href='#ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_advanced_panel' id='\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_advanced' class=\"ipsTabs_item\" role=\"tab\" aria-selected=\"false\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'widget_tab_advanced', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\t<div id='ipsTabs_content_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsTabs_panels'>\n\t\t<div id='ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_settings_panel' class=\"\nCONTENT;\n\nif ( $widget->menuStyle !== 'modal' ):\n$return .= <<<CONTENT\nipsMenu_innerContent\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsTabs_panel ipsPad\" aria-labelledby=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_settings\" aria-hidden=\"false\">\n\t\t\t<ul class='ipsList_reset'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $collection as $inputName => $input ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\mb_substr( $inputName, 0, 12 ) != 'widget_adv__' and ! \\in_array( $inputName, $visibilityFields, TRUE ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\is_object( $input ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$input->rowHtml($form)}\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$input}\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t<div id='ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_visibility_panel' class=\"\nCONTENT;\n\nif ( $widget->menuStyle !== 'modal' ):\n$return .= <<<CONTENT\nipsMenu_innerContent\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsTabs_panel ipsPad\" aria-labelledby=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_visibility\" aria-hidden=\"false\">\n\t\t\t<ul class='ipsList_reset'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $collection as $inputName => $input ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\is_object( $input ) and \\in_array( $input->name, $visibilityFields, TRUE ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t{$input->rowHtml($form)}\n\t\t\t\t\t\t\nCONTENT;\n\nelseif ( \\in_array( $inputName, $visibilityFields, TRUE ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t{$input}\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\n\t\t\nCONTENT;\n\nif ( ( \\in_array( 'IPS\\Widget\\Builder', class_implements( $widget ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t<div id='ipsTabs_tabs_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_advanced_panel' class=\"\nCONTENT;\n\nif ( $widget->menuStyle !== 'modal' ):\n$return .= <<<CONTENT\nipsMenu_innerContent\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nipsTabs_panel ipsPad\" aria-labelledby=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_advanced\" aria-hidden=\"false\">\n\t\t\t<ul class='ipsList_reset'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $collection as $inputName => $input ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\mb_substr( $inputName, 0, 12 ) == 'widget_adv__' and ! \\in_array( $inputName, $visibilityFields, TRUE ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\is_object( $input ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$input->rowHtml($form)}\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$input}\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class='ipsMenu_footerBar ipsType_center'>\n\t\t\nCONTENT;\n\nforeach ( $actionButtons as $button ):\n$return .= <<<CONTENT\n\n\t\t\t{$button}\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/form>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction guestSignUp( $login, $text, $title, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$buttonMethods = $login->buttonMethods();\n$return .= <<<CONTENT\n\n\nCONTENT;\n\n$usernamePasswordMethods = $login->usernamePasswordMethods();\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t<div class='ipsWidget_inner ipsPos_center ipsPad'>\n\t\t<div class=\"ipsAreaBackground_light ipsPad\">\n\t\t    <h2 class=\"ipsType_sectionHead ipsSpacer_bottom ipsSpacer_half\">\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n\t\t    <p class=\"ipsType_richText ipsType_contained\">\n\t\t        {$text}\n\t\t    <\/p>\n\t\t    \n\t\t    \nCONTENT;\n\nif ( $usernamePasswordMethods ):\n$return .= <<<CONTENT\n\n\t\t\t    <ul class=\"ipsList_inline\">\n\t\t\t        <li>\n\t\t\t            <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class=\"ipsButton ipsButton_primary ipsButton_verySmall ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_short', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t        <\/li>\n\t\t\t        <li>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'or', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t        <li>\n\t\t\t            <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class=\"ipsButton ipsButton_primary ipsButton_verySmall ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t        <\/li>\n\t\t\t    <\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\n\t\t    \nCONTENT;\n\nif ( $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t    <div class=''>\n\t\t\t\t\t<form accept-charset='utf-8' method='post' action='\nCONTENT;\n$return .= htmlspecialchars( $login->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"ref\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( base64_encode( \\IPS\\Request::i()->url() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t        \nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t        <div class='ipsType_center ipsPos_center ipsSpacer_top'>\n\t\t\t\t\t            {$method->button()}\n\t\t\t\t\t        <\/div>\n\t\t\t\t        \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t    <\/form>\n\t\t\t    <\/div>\n\t\t    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsWidget_inner ipsPos_center ipsPad_half'>\n\t\t<div class=\"ipsAreaBackground_light ipsPad\">\n\t\t    <div class=\"ipsGrid ipsGrid_collapsePhone\">\n\t\t        <div class='ipsGrid_span\nCONTENT;\n\nif ( $buttonMethods ):\n$return .= <<<CONTENT\n8\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t            <h2 class=\"ipsType_sectionHead ipsSpacer_bottom ipsSpacer_half\">\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n\t\t            <div class=\"ipsType_richText ipsType_contained\">\n\t\t\t\t\t\t{$text}\n\t\t            <\/div>\n\t\t            \n\t\t            \nCONTENT;\n\nif ( $usernamePasswordMethods ):\n$return .= <<<CONTENT\n\n\t\t\t            <ul class=\"ipsList_inline\">\n\t\t\t                <li>\n\t\t\t                    <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=login\", null, \"login\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class=\"ipsButton ipsButton_primary ipsButton_verySmall ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_short', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t                <\/li>\n\t\t\t                <li>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'or', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t                <li>\n\t\t\t                    <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class=\"ipsButton ipsButton_primary ipsButton_verySmall ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t                <\/li>\n\t\t\t            <\/ul>\n\t\t\t        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t        <\/div>\n\t\t        \nCONTENT;\n\nif ( $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t        <div class='ipsGrid_span4 cSignInTeaser_right'>\n\t\t\t\t\t\t<form accept-charset='utf-8' method='post' action='\nCONTENT;\n$return .= htmlspecialchars( $login->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller=\"core.global.core.login\">\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"ref\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( base64_encode( \\IPS\\Request::i()->url() ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t            \nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t            <div class='ipsPad_half ipsType_center ipsPos_center'>\n\t\t\t\t\t                {$method->button()}\n\t\t\t\t\t            <\/div>\n\t\t\t\t            \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t        <\/form>\n\t\t\t        <\/div>\n\t\t        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t    <\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction invite( $subject, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_invite', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n<\/h3>\n<div class='ipsWidget_inner ipsPadding:half ipsType_center'>\n\t<div class=\"ipsPadding_bottom ipsPadding_top:half\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->richText( \\IPS\\Member::loggedIn()->language()->addToStack('block_invite_text', FALSE, array( 'sprintf' => array( \\IPS\\Settings::i()->board_name ) ) ), array('ipsType_reset','ipsType_medium') );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<ul class=\"ipsList_reset ipsFlex ipsFlex-ai:center ipsFlex-jc:stretch ipsFlex-fw:wrap ipsGap:1\">\n\t\t<li class='ipsFlex-flex:11'><a class=\"ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth \" href='mailto:?subject=\nCONTENT;\n$return .= htmlspecialchars( $subject, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n&body=\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class=\"fa fa-envelope\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_invite_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<li class='ipsFlex-flex:11'><a class=\"ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth \" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=invite\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-size=\"narrow\"><i class=\"fa fa-share-alt\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_invite_share', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction members( $members, $title, $display='csv', $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\n\t\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n<\/h3>\n\nCONTENT;\n\nif ( $display === 'csv' ):\n$return .= <<<CONTENT\n\n<div class='ipsWidget_inner ipsPad'>\n\t\nCONTENT;\n\nif ( \\count( $members ) ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsList_inline ipsList_csv ipsList_noSpacing'>\n\t\t\t\nCONTENT;\n\nforeach ( $members as $row ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLinkFromData( $row->member_id, $row->name, $row->members_seo_name, $row->member_group_id );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<p class='ipsType_reset ipsType_medium ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'widget_members_no_results', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n<div class='ipsWidget_inner \nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\nipsPad\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsPad_half\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( \\count( $members )  ):\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsList_reset'>\n\t\t\t\nCONTENT;\n\nforeach ( $members as $member ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsPhotoPanel ipsPhotoPanel_tiny cAnnouncement'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4 class='ipsType_large ipsType_reset'>{$member->link()} <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$member->member_id}&do=reputation\", null, \"profile_reputation\", array( $member->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'  class='ipsPos_right ipsRepBadge \nCONTENT;\n\nif ( $member->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $member->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $member->pp_reputation_points > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $member->pp_reputation_points < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle-o\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $member->pp_reputation_points );\n$return .= <<<CONTENT\n<\/a><\/h4>\n\t\t\t\t\t\t{$member->groupName}\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$htmlsprintf = array($member->joined->html()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'widget_member_joined_date', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->last_activity ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<br><span class='ipsType_light ipsType_small'>\nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $member->last_activity )->html()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'widget_member_last_active_date', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<p class='ipsType_reset'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'widget_members_no_results', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mostContributions( $contributions, $area, $title, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsWidget_inner \nCONTENT;\n\nif ( $orientation !== 'vertical' ):\n$return .= <<<CONTENT\nipsPad\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsPad_half\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t\t<ol class='ipsDataList ipsDataList_reducedSpacing'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $contributions['members'] as $member ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t<div class='ipsDataItem_main ipsPhotoPanel ipsPhotoPanel_tiny ipsClearfix'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{$member->link()}\n\t\t\t\t\t\t\t\t<br><span class='ipsType_light'>\nCONTENT;\n\nif ( $area ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $contributions['counts'][$member->member_id], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->member_posts, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ol>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<ol class='ipsList_inline ipsList_noSpacing'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $contributions['members'] as $idx => $member ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t{$member->link()} <span class='ipsType_light'>\nCONTENT;\n\nif ( $area ):\n$return .= <<<CONTENT\n (\nCONTENT;\n$return .= htmlspecialchars( $contributions['counts'][$member->member_id], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n)\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n (\nCONTENT;\n$return .= htmlspecialchars( $member->member_posts, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n)\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nif ( $idx != \\count( $contributions['members'] ) - 1 ):\n$return .= <<<CONTENT\n,\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ol>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mostSolved( $topSolvedThisWeek, $limit, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_mostSolved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsTabs ipsTabs_small ipsTabs_stretch ipsClearfix' id='elMostSolved' data-ipsTabBar data-ipsTabBar-updateURL='false' data-ipsTabBar-contentArea='#elMostSolved_content'>\n\t<a href='#elMostSolved' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t<ul role=\"tablist\" class='ipsList_reset'>\n\t\t<li>\n\t\t\t<a href='#ipsTabs_elMostSolved_el_MostSolvedWeek_panel' id='el_MostSolvedWeek' class='ipsTabs_item ipsTabs_activeItem' role=\"tab\" aria-selected='true'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'week', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=mostSolved&time=month&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_MostSolvedMonth' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'month', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\t\t\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=mostSolved&time=year&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_MostSolvedYear' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'year', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=mostSolved&time=all&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_MostSolvedAll' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'alltime', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t<\/ul>\n<\/div>\n\n<section id='elMostSolved_content' class='ipsWidget_inner ipsPad_half'>\n\t<div id=\"ipsTabs_elMostSolved_el_MostSolvedWeek_panel\" class='ipsTabs_panel'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"widgets\", \"core\" )->mostSolvedRows( $topSolvedThisWeek, 'week', $orientation );\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/section>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mostSolvedRows( $results, $timeframe, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\count( $results ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsDataList ipsDataList_reducedSpacing cTopContributors'>\n\t\t\t\nCONTENT;\n\n$idx = 1;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $results as $memberId => $solvedCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$member = \\IPS\\Member::load( $memberId );\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t<div class='ipsDataItem_icon ipsPos_middle ipsType_center ipsType_large ipsType_light'><strong>\nCONTENT;\n\n$return .= htmlspecialchars( $idx++, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><\/div>\n\t\t\t\t\t<div class='ipsDataItem_main ipsPhotoPanel ipsPhotoPanel_tiny'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{$member->link()}\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solved_badge_tooltip_time', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge ipsRepBadge_positive'><i class='fa fa-check-circle'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $solvedCount ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsGrid ipsGrid_collapsePhone\">\n\t\t\t\nCONTENT;\n\n$count = 0;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $results as $memberId => $solvedCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $count == 4 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nbreak;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$count++;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$member = \\IPS\\Member::load( $memberId );\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsGrid_span3'>\n\t\t\t\t\t<div class='ipsPad_half ipsPhotoPanel ipsPhotoPanel_tiny'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p class='ipsType_reset ipsTruncate ipsTruncate_line'>\n\t\t\t\t\t\t\t\t{$member->link()}\n\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'solved_badge_tooltip_time', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge ipsRepBadge_positive'><i class='fa fa-check-circle'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $solvedCount ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsPad'>\n\t\t<p class='ipsType_reset'>\nCONTENT;\n\n$val = \"top_solved_empty__{$timeframe}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction newsletter( $ref ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\n\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_newsletter_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n<\/h3>\n<div class='ipsWidget_inner ipsPad'>\n\t<span class=\"ipsType ipsType_veryLarge ipsPos_right ipsPad\"><i class=\"fa fa-envelope\"><\/i><\/span>\n\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->richText( \\IPS\\Member::loggedIn()->language()->addToStack('block_newsletter_signup'), array('ipsType_reset','ipsType_medium') );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t<a class=\"ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth\" href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=newsletterSubscribe&ref={$ref}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"settings\", array(), 0 )->addRef($ref), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_newsletter_signup_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<a class=\"ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth\" href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=register&newsletter=1\", null, \"register\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'normal' ):\n$return .= <<<CONTENT\ndata-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_newsletter_signup_button', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pagebuilderoembed( $video ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsPos_center'>{$video}<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pagebuildertext( $text ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div>{$text}<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction pagebuilderupload( $images ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! \\is_array( $images ) ):\n$return .= <<<CONTENT\n\n<div><img src=\"\nCONTENT;\n$return .= htmlspecialchars( $images, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsPageBuilderUpload\"><\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction profile( $nextStep, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsSpacer_bottom ipsPad_half' data-role='profileWidget' data-controller=\"core.front.core.profileCompletion\">\n\t\nCONTENT;\n\nif ( $orientation == 'horizontal' ):\n$return .= <<<CONTENT\n\n\t\t<span class='ipsPos_right'><a class='ipsButton ipsButton_primary' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&_new=1&do=completion\", null, \"settings\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'complete_my_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'or', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a class='ipsButton ipsButton_link' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=dismissProfile\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-role='dismissProfile'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dismiss', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/span>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsType_richText'>\nCONTENT;\n\n$val = \"profile_step_text_{$nextStep->id}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t<span class=\"ipsAttachment_progress\"><span style='width: \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->profileCompletionPercentage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n%'><\/span><\/span><br>\n\t<span class='ipsType_light'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->profileCompletionPercentage() . '%'); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profile_completion_percent', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t<br>\n\t\t<a class='ipsButton ipsButton_primary' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=completion&_new=1\", null, \"settings\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'complete_my_profile', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'or', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a class='ipsButton ipsButton_link' href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=dismissProfile\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 )->addRef((string) \\IPS\\Request::i()->url()), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' data-role='dismissProfile'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dismiss', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction promoted( $promoted, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_promoted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='\nCONTENT;\n\nif ( $orientation !== 'vertical' ):\n$return .= <<<CONTENT\nipsPad\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsPad_half\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsWidget_inner'>\n\t\nCONTENT;\n\nif ( $orientation !== 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsCarousel ipsClearfix cPromotedWidget_horizontal' data-ipsCarousel>\n\t\t\t<div class='ipsCarousel_inner'>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<ul class='ipsList_reset \nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\ncPromotedWidget_vertical ipsDataList\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-role='carouselItems'>\n\t\t\nCONTENT;\n\nforeach ( $promoted as $item ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$photoCount = ( $imageObjects = $item->imageObjects() ) ? \\count( $imageObjects ) : 0;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$staff = \\IPS\\Member::load( $item->added_by );\n$return .= <<<CONTENT\n\n\t\t\t<li class='cPromoted cPromotedWidgetItem \nCONTENT;\n\nif ( $orientation !== 'vertical' ):\n$return .= <<<CONTENT\nipsBox ipsBox--child ipsCarousel_item\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsDataItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-ipsLazyLoad>\n\t\t\t\t\nCONTENT;\n\nif ( $photoCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$firstPhoto = $item->imageObjects()[0];\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->object()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsAreaBackground_dark cPromotedHeader' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\ndata-background-src='\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $firstPhoto->url );;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nstyle='background-image: url(\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $firstPhoto->url );;\n$return .= <<<CONTENT\n)'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t<img \nCONTENT;\n\nif ( \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n$return .= htmlspecialchars( $firstPhoto->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsHide' alt=\"\nCONTENT;\n$return .= htmlspecialchars( $item->objectTitle, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $photoCount > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class='ipsGrid cPromotedImages ipsClearfix ipsAreaBackground_light' data-ipsGrid data-ipsGrid-minItemSize='40' data-ipsGrid-maxItemSize='60'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $item->imageObjects() as $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsGrid_span4'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\ndata-background-src='\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $file->url );;\n$return .= <<<CONTENT\n'\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nstyle='background-image: url(\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $file->url );;\n$return .= <<<CONTENT\n)'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n data-ipsLightbox data-ipsLightbox-group='g\nCONTENT;\n$return .= htmlspecialchars( $item->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t<img \nCONTENT;\n\nif ( \\IPS\\Settings::i()->lazy_load_enabled ):\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\nsrc='\nCONTENT;\n$return .= htmlspecialchars( $file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' alt='' class='ipsHide'>\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsPad cPromotedWidgetItem_content'>\n\t\t\t\t\t<h2 class='ipsType_reset ipsType_large ipsType_blendLinks ipsType_break cPromotedTitle'>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $item->object()->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $item->ourPicksTitle, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/h2>\n\t\t\t\t\t<p class='ipsType_reset ipsType_light ipsType_medium ipsType_blendLinks'>\n\t\t\t\t\t\t{$item->objectMetaDescription}\n\t\t\t\t\t<\/p>\n\t\t\t\t\t<div class='cPromotedWidgetItem_contentInner'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $text = $item->getText('internal', true) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class=\"ipsType_richText ipsType_medium ipsSpacer_both ipsSpacer_half\" data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='4 lines'>{$text}<\/div>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$reactionClass = $item->objectReactionClass;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $reactionClass || $item->objectDataCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<ul class='ipsList_inline ipsType_light ipsSpacer_bottom'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $reactionClass ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->reactionOverview( $reactionClass, FALSE );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $counts = $item->objectDataCount ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<li><i class='fa fa-comment'><\/i> \nCONTENT;\n$return .= htmlspecialchars( $counts['words'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<div class='ipsPhotoPanel ipsPhotoPanel_tiny ipsType_blendLinks ipsType_light'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $staff, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->sent AND $item->share_to AND \\count( $item->share_to ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<ul class='ipsList_inline cPromotedNetworks'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $item->share_to as $service ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $service == 'internal' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\ncontinue;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $url = $item->getPublishedUrl( $service ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$sharer = $item->getPromoter( $service );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<li class='ipsPos_right'>\n\t\t\t\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='cShareLink cShareLink_\nCONTENT;\n$return .= htmlspecialchars( $service, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$sprintf = array($sharer->key); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promote_shared_on', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $sharer::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'promoted_by', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLink( $staff );\n$return .= <<<CONTENT\n, \nCONTENT;\n\n$val = ( $item->sent instanceof \\IPS\\DateTime ) ? $item->sent : \\IPS\\DateTime::ts( $item->sent );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nif ( $orientation !== 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n\t\t\t<span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n\t\t\t<a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n<div class='ipsPad_half ipsWidget_inner ipsWidget_bottomBar'>\n\t<div class='ipsType_center ipsAreaBackground_light ipsPad_half'>\n\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=promote&controller=ourpicks\", null, \"promote_show\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_all_picks', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction recentStatusUpdates( $statuses, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_recentStatusUpdates', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsWidget_inner cStatusUpdateWidget' data-controller=\"core.front.core.statusFeedWidget\">\n\t\nCONTENT;\n\nif ( \\IPS\\core\\Statuses\\Status::canCreateFromCreateMenu() ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsAreaBackground ipsPad_half\" data-role='statusFormArea'>\n\t\t\t<div class='ipsComposeArea_editor' data-role='statusDummy'>\n\t\t\t\t<div class='ipsComposeArea_dummy ipsType_light' tabindex='-1'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'status_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<div data-role='statusEditor' class='ipsHide'><\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<ul class='ipsDataList' data-role=\"statusFeed\">\n\t\t\nCONTENT;\n\nforeach ( $statuses as $status ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"widgets\", \"core\" )->recentStatusUpdatesStatus( $status );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\t\nCONTENT;\n\nif ( \\count( $statuses ) == 0 ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center ipsType_light ipsPad_half' data-role=\"statusFeedEmpty\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_recent_statuses', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction recentStatusUpdatesStatus( $status ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<li class='ipsDataItem \nCONTENT;\n\nif ( $status->hidden() ):\n$return .= <<<CONTENT\n ipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-statusID='\nCONTENT;\n$return .= htmlspecialchars( $status->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t<div class='ipsDataItem_icon ipsPos_top'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $status->author(), 'tiny' );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class='ipsDataItem_main ipsType_medium ipsType_break'>\n\t\t<p class='ipsType_medium ipsType_reset'>\n\t\t\t\nCONTENT;\n\nif ( $status->member_id != $status->author()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<strong class='ipsType_light'>{$status->author()->link()}<\/strong> &nbsp;&raquo;&nbsp; <strong>\nCONTENT;\n\n$return .= \\IPS\\Member::load( $status->member_id )->link();\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<strong>{$status->author()->link()}<\/strong>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/p> \n\t\t<div class='ipsType_richText ipsContained' data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='3 lines' data-ipsTruncate-watch='false'>\n\t\t\t{$status->truncated()}\n\t\t<\/div>\n\t\t<span class='ipsType_light ipsType_small ipsType_blendLinks'><a href='\nCONTENT;\n$return .= htmlspecialchars( $status->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $status->date instanceof \\IPS\\DateTime ) ? $status->date : \\IPS\\DateTime::ts( $status->date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nif ( $status->replies or $status->canComment() ):\n$return .= <<<CONTENT\n &middot; <a href=\"\nCONTENT;\n$return .= htmlspecialchars( $status->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$pluralize = array( $status->replies ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'status_num_replies', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/a>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t<\/div>\n<\/li>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction relatedContent( $similar, $title, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !empty( $similar )  ):\n$return .= <<<CONTENT\n\n<h3 class='ipsWidget_title ipsType_reset'>\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n\n\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t<div class='ipsPad_half ipsWidget_inner'>\n\t\t<ul class='ipsDataList ipsDataList_reducedSpacing'>\n\t\t\t\nCONTENT;\n\nforeach ( $similar as $item ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$numComments = ( $item::$firstCommentRequired ) ? $item->mapped('num_comments') - 1 : $item->mapped('num_comments');\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsDataItem \nCONTENT;\n\nif ( $item->hidden() ):\n$return .= <<<CONTENT\n ipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t<div class='ipsDataItem_icon ipsPos_top'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $item->author(), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsDataItem_main cWidgetComments'>\n\t\t\t\t\t\t<div class=\"ipsCommentCount ipsPos_right \nCONTENT;\n\nif ( $numComments === 0 ):\n$return .= <<<CONTENT\nipsFaded\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-ipsTooltip title='\nCONTENT;\n\n$pluralize = array( $numComments ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber($numComments), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class='ipsType_break ipsContained'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('featured') || $item->hidden() === -1 || $item->hidden() === 1 || \\IPS\\IPS::classUsesTrait( $item, 'IPS\\Content\\Solvable' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n$return .= htmlspecialchars( $item->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $item->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('featured') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-star'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $item, 'IPS\\Content\\Solvable' ) and $item->isSolved() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_solved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-check'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $item->url( \"getPrefComment\" ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" title='\nCONTENT;\n\n$sprintf = array($item->title); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_this_topic', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n' class='ipsDataItem_title'>\nCONTENT;\n$return .= htmlspecialchars( $item->mapped('title'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<p class='ipsType_reset ipsType_medium ipsType_blendLinks ipsContained'>\n\t\t\t\t\t\t\t<span>\nCONTENT;\n\n$htmlsprintf = array($item->author()->link( NULL, NULL, $item->isAnonymous() )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t\t\t<span class='ipsType_light'>\nCONTENT;\n\n$htmlsprintf = array(\\IPS\\DateTime::ts( $item->mapped('date') )->html()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'started_date', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsWidget_inner'>\n\t\t<ul class='ipsDataList'>\n\t\t\t\nCONTENT;\n\nforeach ( $similar as $item ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsDataItem ipsDataItem_responsivePhoto \nCONTENT;\n\nif ( $item->hidden() ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\t<h4 class='ipsDataItem_title ipsContained_container'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('pinned') || $item->mapped('featured') || $item->hidden() === -1 || $item->hidden() === 1 || \\IPS\\IPS::classUsesTrait( $item, 'IPS\\Content\\Solvable' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->hidden() === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n$return .= htmlspecialchars( $item->hiddenBlurb(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $item->hidden() === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('pinned') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pinned', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-thumb-tack'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('featured') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-star'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $item, 'IPS\\Content\\Solvable' ) and $item->isSolved() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'this_is_solved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-check'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->prefix() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->prefix( $item->prefix( TRUE ), $item->prefix() );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class='ipsType_break ipsContained'>\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url( \"getPrefComment\" ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $item->canView() ):\n$return .= <<<CONTENT\ndata-ipsHover data-ipsHover-target='\nCONTENT;\n$return .= htmlspecialchars( $item->url()->setQueryString('preview', 1), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsHover-timeout='1.5' \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $item->mapped('title'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->commentPageCount() > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$item->commentPagination( array(), 'miniPagination' )}\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/h4>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<p class='ipsType_reset ipsType_medium ipsType_light'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$htmlsprintf = array($item->author()->link( NULL, NULL, $item->isAnonymous() )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$val = ( $item->mapped('date') instanceof \\IPS\\DateTime ) ? $item->mapped('date') : \\IPS\\DateTime::ts( $item->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\count( $item->tags() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tags( $item->tags(), true, true );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<ul class='ipsDataItem_stats'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $item->stats(FALSE) as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li \nCONTENT;\n\nif ( \\in_array( $k, $item->hotStats ) ):\n$return .= <<<CONTENT\nclass=\"ipsDataItem_stats_hot\" data-text='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hot_item', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hot_item_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t<span class='ipsDataItem_stats_number'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $v );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t<span class='ipsDataItem_stats_type'>\nCONTENT;\n\n$val = \"{$k}\"; $pluralize = array( $v ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\t<ul class='ipsDataItem_lastPoster ipsDataItem_withPhoto'>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('num_comments') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $item->lastCommenter(), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $item->author(), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('num_comments') ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$item->lastCommenter()->link()}\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t{$item->author()->link( NULL, NULL, $item->isAnonymous() )}\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class=\"ipsType_light\">\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $item->url( 'getLastComment' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'get_last_post', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsType_blendLinks'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $item->mapped('last_comment') ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = ( $item->mapped('last_comment') instanceof \\IPS\\DateTime ) ? $item->mapped('last_comment') : \\IPS\\DateTime::ts( $item->mapped('last_comment') );$return .= $val->html();\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = ( $item->mapped('date') instanceof \\IPS\\DateTime ) ? $item->mapped('date') : \\IPS\\DateTime::ts( $item->mapped('date') );$return .= $val->html();\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction stats( $stats, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_stats', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsWidget_inner'>\n\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsPad_half'>\n\t\t\t<ul class=\"ipsDataList\">\n\t\t\t\t<li class=\"ipsDataItem\">\n\t\t\t\t\t<div class=\"ipsDataItem_main ipsPos_middle\">\n\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_total_members', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class=\"ipsDataItem_stats ipsDataItem_statsLarge\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_stats_number\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $stats['member_count'] );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\t<li class=\"ipsDataItem\">\n\t\t\t\t\t<div class=\"ipsDataItem_main ipsPos_middle\">\n\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_most_online', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class=\"ipsDataItem_stats ipsDataItem_statsLarge\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_stats_number\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $stats['most_online']['count'] );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t\t<span class=\"ipsType_light ipsType_small\"><time>\nCONTENT;\n$return .= htmlspecialchars( $stats['most_online']['time'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/time><\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t<\/ul>\n\t\t\t<hr class='ipsHr'>\n\t\t\t\nCONTENT;\n\nif ( $stats['last_registered'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsClearfix ipsPadding_bottom'>\n\t\t\t\t\t<div class='ipsPos_left ipsType_center cNewestMember'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $stats['last_registered'], 'small' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsWidget_latestItem'>\n\t\t\t\t\t\t<strong class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_newest_member', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t<span class='ipsType_normal'>{$stats['last_registered']->link()}<\/span><br>\n\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_joined', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <time>\nCONTENT;\n$return .= htmlspecialchars( $stats['last_registered']->joined->getTimestamp(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/time><\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class='ipsFlex ipsFlex-ai:center ipsFlex-jc:between sm:ipsFlex-fd:column sm:ipsFlex-ai:stretch ipsPadding ipsWidget_stats'>\n\t\t\t<div class='ipsFlex-flex:11 ipsFlex ipsFlex-ai:center ipsFlex-jc:around'>\n\t\t\t\t<div class='ipsType_center'>\n\t\t\t\t\t<span class='ipsType_large ipsWidget_statsCount'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $stats['member_count'] );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t<span class='ipsType_light ipsType_medium'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_total_members', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsType_center'>\n\t\t\t\t\t<span class='ipsType_large ipsWidget_statsCount' data-ipsTooltip title='<time data-norelative=\"true\">\nCONTENT;\n$return .= htmlspecialchars( $stats['most_online']['time'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/time>'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $stats['most_online']['count'] );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t<span class='ipsType_light ipsType_medium'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_most_online', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( $stats['last_registered'] instanceof \\IPS\\Member ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsFlex-flex:01 ipsBorder_left ipsPadding_left ipsMargin_right:double sm:ipsMargin_right:none sm:ipsMargin_top sm:ipsBorder:none sm:ipsBorder_top sm:ipsPadding_top sm:ipsPadding_left:none sm:ipsFlex sm:ipsFlex-jc:center'>\n\t\t\t\t<div class='ipsPhotoPanel ipsPhotoPanel_mini cNewestMember'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $stats['last_registered'], 'mini' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'stats_newest_member', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t\t<span class='ipsType_normal'>{$stats['last_registered']->link()}<\/span><br>\n\t\t\t\t\t\t<span class='ipsType_small ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_joined', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <time>\nCONTENT;\n$return .= htmlspecialchars( $stats['last_registered']->joined->getTimestamp(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/time><\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction stream( $stream, $results, $title, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsWidget_title'>\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h3>\n<div class='\nCONTENT;\n\nif ( $orientation == \"vertical\" ):\n$return .= <<<CONTENT\nipsPadding_horizontal:half ipsPadding_bottom:half \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n ipsPadding_horizontal ipsPadding_bottom \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsWidget_inner'>\n<ol class=\"cWidgetStreamList ipsList_reset\">\n\nCONTENT;\n\nforeach ( $results AS $result ):\n$return .= <<<CONTENT\n\n\t{$result->html($orientation, $stream->include_comments ? 'last_comment' : 'date', TRUE, $result->asArray()['indexData']['index_class']::searchResultBlock() )}\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ol>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction streamItem( $indexData, $articles, $authorData, $itemData, $unread, $objectUrl, $itemUrl, $containerUrl, $containerTitle, $repCount, $showRepUrl, $snippet, $iPostedIn, $view, $canIgnoreComments=FALSE, $reactions=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<li class='cWidgetStream ipsFlex \nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\nipsGap:5\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsGap:3\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-orientation=\"\nCONTENT;\n$return .= htmlspecialchars( $view, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Comment', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$itemClass = $indexData['index_class']::$itemClass;\n$return .= <<<CONTENT\n\n\t\t<div class=\"cWidgetStream__icon ipsFlex-flex:00\">\n\t\t\t\nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhotoFromData( $authorData['member_id'], $authorData['name'], $authorData['members_seo_name'], \\IPS\\Member::photoUrl( $authorData ), ( $view == 'horizontal' ) ? 'mini' : 'tiny' );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='cWidgetStreamIcon' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$itemClass::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $itemClass::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i><\/span>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t<span class='cWidgetStreamIcon' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$indexData['index_class']::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $indexData['index_class']::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i><\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\n\t\t<\/div>\n\t\t<div class='cWidgetStream__main ipsFlex-flex:11'>\n\t\t\t\nCONTENT;\n\nif ( isset( $itemClass::$databaseColumnMap['num_comments'] ) and isset( $itemData[ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ] ) ):\n$return .= <<<CONTENT\n\t\n\t\t\t\t\nCONTENT;\n\n$commentCount = $itemData[ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ];\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $itemClass::$firstCommentRequired ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsCommentCount ipsPos_right\" data-ipsTooltip title='\nCONTENT;\n\n$pluralize = array( $commentCount - 1 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $commentCount - 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsCommentCount ipsPos_right\" data-ipsTooltip title='\nCONTENT;\n\n$pluralize = array( $commentCount ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $commentCount ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_break\">\n\t\t\t\t<h4 class='ipsDataItem_title \nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\nipsType_large ipsType_break\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $indexData['index_prefix'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->prefix( rawurlencode($indexData['index_prefix']), $indexData['index_prefix'] );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsType_break'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $objectUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-linkType=\"link\" data-searchable>\nCONTENT;\n$return .= htmlspecialchars( $itemData[ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['title'] ], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/span>\n\t\t\t\t\t\nCONTENT;\n\nif ( $indexData['index_hidden'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $indexData['index_hidden'] === -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $indexData['index_hidden'] === 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_small ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'pending_approval', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-warning'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/h4>\n\t\t\t\t<div class='ipsType_reset ipsType_blendLinks ipsType_medium'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"system\", \"core\", 'front' )->searchResultSnippet( $indexData );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\IPS::classUsesTrait( $indexData['index_class'], 'IPS\\Content\\Reactable' ) and \\IPS\\Settings::i()->reputation_enabled and \\count( $reactions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Review', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class=\"cWidgetStreamReaction\">\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"search\", \"core\" )->searchReaction( $reactions, $itemUrl->setQueryString('do', 'showReactionsReview')->setQueryString('review', $indexData['index_object_id']), $repCount );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class=\"cWidgetStreamReaction\">\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"search\", \"core\" )->searchReaction( $reactions, $itemUrl->setQueryString('do', 'showReactionsComment')->setQueryString('comment', $indexData['index_object_id']), $repCount );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\n\t\t\t\t<div class='cWidgetStreamTime ipsType_blendLinks ipsType_light ipsType_medium'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<i class='fa fa-clock-o'><\/i> <a href='\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Review', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findReview', 'review' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findComment', 'comment' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $indexData['index_date_created'] instanceof \\IPS\\DateTime ) ? $indexData['index_date_created'] : \\IPS\\DateTime::ts( $indexData['index_date_created'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/a> - \nCONTENT;\n\n$return .= htmlspecialchars( $itemClass::searchResultSummaryLanguage( $authorData, $articles, $indexData, $itemData ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n$return .= htmlspecialchars( $containerUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>{$containerTitle}<\/a>\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhotoFromData( $authorData['member_id'], $authorData['name'], $authorData['members_seo_name'], \\IPS\\Member::photoUrl( $authorData ), ( $view == 'horizontal' ) ? 'mini' : 'tiny' );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Review', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findReview', 'review' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findComment', 'comment' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $indexData['index_date_created'] instanceof \\IPS\\DateTime ) ? $indexData['index_date_created'] : \\IPS\\DateTime::ts( $indexData['index_date_created'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/a> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n$return .= htmlspecialchars( $containerUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>{$containerTitle}<\/a>\t\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nif ( isset( $indexData['index_tags'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tags( explode( ',', $indexData['index_tags'] ), true, true );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$itemClass = $indexData['index_class'];\n$return .= <<<CONTENT\n\n\t\t<div class=\"cWidgetStream__icon ipsFlex-flex:00\">\n\t\t\t\nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhotoFromData( $authorData['member_id'], $authorData['name'], $authorData['members_seo_name'], \\IPS\\Member::photoUrl( $authorData ), ( $view == 'horizontal' ) ? 'mini' : 'tiny' );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='cWidgetStreamIcon' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$itemClass::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $itemClass::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i><\/span>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\t\t\t\t\n\t\t\t\t<span class='cWidgetStreamIcon' data-ipsTooltip title='\nCONTENT;\n\n$val = \"{$indexData['index_class']::$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $indexData['index_class']::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i><\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div class='cWidgetStream__main ipsFlex-flex:11'>\n\t\t\t\nCONTENT;\n\nif ( isset( $itemClass::$databaseColumnMap['num_comments'] ) and isset( $itemData[ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$commentCount = $itemData[ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ];\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $itemClass::$firstCommentRequired ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsCommentCount ipsPos_right\" data-ipsTooltip title='\nCONTENT;\n\n$pluralize = array( $commentCount - 1 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $commentCount - 1 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class=\"ipsCommentCount ipsPos_right\" data-ipsTooltip title='\nCONTENT;\n\n$pluralize = array( $commentCount ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'replies_number', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $commentCount ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsType_break'>\n\t\t\t\t<h4 class='ipsDataItem_title \nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\nipsType_large ipsType_break\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $indexData['index_prefix'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->prefix( rawurlencode($indexData['index_prefix']), $indexData['index_prefix'] );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsType_break'><a href='\nCONTENT;\n$return .= htmlspecialchars( $itemUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-linkType=\"link\" data-searchable>\nCONTENT;\n$return .= htmlspecialchars( $indexData['index_title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n                    \nCONTENT;\n\nif ( $indexData['index_hidden'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_icon ipsBadge_warning ipsBadge_medium \" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'hidden', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                    <\/span>\n\t\t\t\t<\/h4>\n\t\t\t\t\nCONTENT;\n\nif ( $containerTitle ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsType_reset ipsType_blendLinks ipsType_light ipsType_medium'>\n\t\t\t\t\t\t{$snippet}\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='cWidgetStreamTime ipsType_blendLinks ipsType_light ipsType_medium'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $view == 'horizontal' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<i class='fa fa-clock-o'><\/i> <a href='\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Review', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findReview', 'review' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findComment', 'comment' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $indexData['index_date_created'] instanceof \\IPS\\DateTime ) ? $indexData['index_date_created'] : \\IPS\\DateTime::ts( $indexData['index_date_created'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/a> - \nCONTENT;\n\n$return .= htmlspecialchars( $itemClass::searchResultSummaryLanguage( $authorData, $articles, $indexData, $itemData ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n$return .= htmlspecialchars( $containerUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>{$containerTitle}<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhotoFromData( $authorData['member_id'], $authorData['name'], $authorData['members_seo_name'], \\IPS\\Member::photoUrl( $authorData ), ( $view == 'horizontal' ) ? 'mini' : 'tiny' );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n\nif ( $indexData['index_title'] ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\nif ( \\in_array( 'IPS\\Content\\Review', class_parents( $indexData['index_class'] ) ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findReview', 'review' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $objectUrl->setQueryString( array( 'do' => 'findComment', 'comment' => $indexData['index_object_id'] ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$val = ( $indexData['index_date_created'] instanceof \\IPS\\DateTime ) ? $indexData['index_date_created'] : \\IPS\\DateTime::ts( $indexData['index_date_created'] );$return .= $val->html();\n$return .= <<<CONTENT\n<\/a> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <a href='\nCONTENT;\n$return .= htmlspecialchars( $containerUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>{$containerTitle}<\/a>\t\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $indexData['index_tags'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->tags( explode( ',', $indexData['index_tags'] ), true, true );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/li>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction topContributorRows( $results, $timeframe, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\count( $results ) ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $orientation == 'vertical' ):\n$return .= <<<CONTENT\n\n\t\t<ol class='ipsDataList ipsDataList_reducedSpacing cTopContributors'>\n\t\t\t\nCONTENT;\n\n$idx = 1;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $results as $memberId => $rep ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$member = \\IPS\\Member::load( $memberId );\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t<div class='ipsDataItem_icon ipsPos_middle ipsType_center ipsType_large ipsType_light'><strong>\nCONTENT;\n\n$return .= htmlspecialchars( $idx++, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/strong><\/div>\n\t\t\t\t\t<div class='ipsDataItem_main ipsPhotoPanel ipsPhotoPanel_tiny'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{$member->link()}\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$member->member_id}&do=reputation\", null, \"profile_reputation\", array( $member->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip_period', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle-o\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $rep ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip_period', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle-o\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $rep ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ol>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_leaderboard_on and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsMargin_top:half\">\n\t\t\t\t\nCONTENT;\n\n$_timeframe = $timeframe == 'all' ? 'time=oldest' : ( $timeframe == 'year' ? ( 'custom_date_start=' . ( time() - 31536000 ) ) : ( 'time=' . $timeframe ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=discover&controller=popular&tab=leaderboard&{$_timeframe}\", null, \"leaderboard_leaderboard\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'leaderboard_show_more', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsGrid ipsGrid_collapsePhone\">\n\t\t\t\nCONTENT;\n\n$count = 0;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $results as $memberId => $rep ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $count == 4 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nbreak;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$count++;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$member = \\IPS\\Member::load( $memberId );\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsGrid_span3'>\n\t\t\t\t\t<div class='ipsPad_half ipsPhotoPanel ipsPhotoPanel_tiny'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<p class='ipsType_reset ipsTruncate ipsTruncate_line'>\n\t\t\t\t\t\t\t\t{$member->link()}\n\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->group['gbw_view_reps'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=profile&id={$member->member_id}&do=reputation\", null, \"profile_reputation\", array( $member->members_seo_name ), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip_period', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle-o\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $rep ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<span title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_badge_tooltip_period', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip class='ipsRepBadge \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nipsRepBadge_positive\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nipsRepBadge_negative\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsRepBadge_neutral\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><i class='fa \nCONTENT;\n\nif ( $rep > 0 ):\n$return .= <<<CONTENT\nfa-plus-circle\nCONTENT;\n\nelseif ( $rep < 0 ):\n$return .= <<<CONTENT\nfa-minus-circle\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfa-circle-o\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'><\/i> \nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Member::loggedIn()->language()->formatNumber( $rep ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_leaderboard_on and \\IPS\\Member::loggedIn()->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'discover' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t\nCONTENT;\n\n$_timeframe = $timeframe == 'all' ? 'time=oldest' : ( $timeframe == 'year' ? ( 'custom_date_start=' . ( time() - 31536000 ) ) : ( 'time=' . $timeframe ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=discover&controller=popular&tab=leaderboard&{$_timeframe}\", null, \"leaderboard_leaderboard\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_small ipsButton_light ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'leaderboard_show_more', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsPad'>\n\t\t<p class='ipsType_reset'>\nCONTENT;\n\n$val = \"top_contributors_empty__{$timeframe}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction topContributors( $topContributorsThisWeek, $limit, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<h3 class='ipsType_reset ipsWidget_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_topContributors', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n<div class='ipsTabs ipsTabs_small ipsTabs_stretch ipsClearfix' id='elTopContributors' data-ipsTabBar data-ipsTabBar-updateURL='false' data-ipsTabBar-contentArea='#elTopContributors_content'>\n\t<a href='#elTopContributors' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t<ul role=\"tablist\" class='ipsList_reset'>\n\t\t<li>\n\t\t\t<a href='#ipsTabs_elTopContributors_el_topContributorsWeek_panel' id='el_topContributorsWeek' class='ipsTabs_item ipsTabs_activeItem' role=\"tab\" aria-selected='true'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'week', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=topContributors&time=month&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_topContributorsMonth' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'month', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\t\t\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=topContributors&time=year&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_topContributorsYear' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'year', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=ajax&do=topContributors&time=all&limit={$limit}&orientation={$orientation}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' id='el_topContributorsAll' class='ipsTabs_item' role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'alltime', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/li>\n\t<\/ul>\n<\/div>\n\n<section id='elTopContributors_content' class='ipsWidget_inner ipsPad_half'>\n\t<div id=\"ipsTabs_elTopContributors_el_topContributorsWeek_panel\" class='ipsTabs_panel'>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"widgets\", \"core\" )->topContributorRows( $topContributorsThisWeek, 'week', $orientation );\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/section>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction twitter( $username, $locale, $style=NULL, $color=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class='ipsPad_half'>\n\t<a class=\"twitter-timeline\" data-lang=\"\nCONTENT;\n$return .= htmlspecialchars( $locale, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-height=\"500\" \nCONTENT;\n\nif ( $style ):\n$return .= <<<CONTENT\ndata-theme=\"\nCONTENT;\n$return .= htmlspecialchars( $style, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $color ):\n$return .= <<<CONTENT\ndata-link-color=\"\nCONTENT;\n$return .= htmlspecialchars( $color, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n href=\"https:\/\/twitter.com\/\nCONTENT;\n$return .= htmlspecialchars( $username, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n?ref_src=twsrc%5Etfw\">Tweets by \nCONTENT;\n$return .= htmlspecialchars( $username, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a> \t\t<script async src=\"https:\/\/platform.twitter.com\/widgets.js\" charset=\"utf-8\"><\/script>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction whosOnline( $members, $memberCount, $guests, $anonymous, $orientation='vertical' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller='core.front.core.onlineUsersWidget'>\n    <h3 class='ipsType_reset ipsWidget_title'>\n        \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_whosOnline', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nif ( $orientation == 'horizontal' ):\n$return .= <<<CONTENT\n\n            &nbsp;&nbsp;<span class='ipsType_light ipsType_unbold ipsType_medium'><span data-memberCount=\"\nCONTENT;\n$return .= htmlspecialchars( $memberCount, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$pluralize = array( $memberCount ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_whos_online_info_members', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>, \nCONTENT;\n\n$pluralize = array( $anonymous ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_whos_online_info_anonymous', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n, \nCONTENT;\n\n$pluralize = array( $guests ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'block_whos_online_info_guests', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/span>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <span class='ipsType_medium ipsType_light ipsType_unbold ipsType_blendLinks'><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=online&controller=online\", null, \"online\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_full_list', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/span>\n    <\/h3>\n    <div class='ipsWidget_inner ipsPadding'>\n        <ul class='ipsList_inline ipsList_csv ipsList_noSpacing ipsType_normal'>\n            \nCONTENT;\n\nif ( $memberCount ):\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nforeach ( $members as $row ):\n$return .= <<<CONTENT\n\n                    <li data-memberId=\"\nCONTENT;\n$return .= htmlspecialchars( $row['member_id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userLinkFromData( $row['member_id'], $row['member_name'], $row['seo_name'], $row['member_group'], TRUE );\n$return .= <<<CONTENT\n<\/li>\n                \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                <li class='ipsType_reset ipsType_medium ipsType_light' data-noneOnline>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'whos_online_users_empty', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <\/ul>\n        \nCONTENT;\n\nif ( $orientation == 'vertical' and $memberCount > 60 ):\n$return .= <<<CONTENT\n\n            <p class='ipsType_medium ipsType_reset'>\n                <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=online&controller=online\", null, \"online\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n'>\nCONTENT;\n\n$pluralize = array( $memberCount - 60 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'and_x_others', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/a>\n            <\/p>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    <\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
