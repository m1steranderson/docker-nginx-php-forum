<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_admin_marketplace extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '8d061c0d560298a502488f932dbeb89a';\n\tfunction categoryIndex( $categoryId, $resultSet ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-role=\"hideWhenSearching\">\n    \nCONTENT;\n\nif ( !\\count( $resultSet['results'] ) ):\n$return .= <<<CONTENT\n\n        <p class=\"ipsType_normal ipsType_light ipsType_center\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_error_no_resources', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n        <div class='ipsGrid ipsGrid_collapsePhone' data-ipsGrid data-ipsgrid-minitemsize=\"250\" data-ipsGrid-maxitemsize=\"500\" data-ipsGrid-equalheights=\"row\" data-ipsLazyLoad>\n            \nCONTENT;\n\nforeach ( $resultSet['results'] as $file ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCard( $file );\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n        <\/div>\n        <br>\n        \nCONTENT;\n\nif ( $resultSet['totalPages'] > 1 ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( \\IPS\\Http\\Url::internal('app=core&module=marketplace&controller=marketplace&do=viewCategory&id=' . $categoryId ), $resultSet['totalPages'], $resultSet['page'], $resultSet['perPage'], TRUE, 'page' );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n<div data-role=\"results\"><\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction customHeader( $title, $authenticatedMember, $authenticationUrl, $authenticationError, $file=NULL, $categoryIds=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !$file ):\n$return .= <<<CONTENT\n<div data-controller=\"core.admin.marketplace.search\" data-category=\"\nCONTENT;\n\nif ( $categoryIds ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( implode( ',', $categoryIds ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-compatible=\"1\">\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div id='acpPageHeader'>\n\t<div class='ipsFlex ipsFlex-ai:center ipsFlex-fw:wrap'>\n\t\t\n\t\t<div class='ipsFlex-flex:11'>\n\t\t\t<h1 class=\"ipsType_pageTitle ipsType_break\">\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/h1>\n\t\t\t\nCONTENT;\n\nif ( $file ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class=\"ipsType_light\">\n\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($file['version']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_version_short', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($file['author']['profileUrl'], $file['author']['name'], ( new \\IPS\\DateTime( $file['updated'] ) )->relative()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\n\t\t<div class=\"ipsFlex ipsFlex-ai:center ipsGap_row:2 sm:ipsFlex-ai:stretch sm:ipsFlex-fd:column ipsFlex-fw:wrap sm:ipsFlex-flex:11\">\n            \nCONTENT;\n\nif ( \\IPS\\IPS::canManageResources() ):\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nif ( \\IPS\\Http\\Url::internal('')->data['host'] != 'localhost' AND !\\IPS\\DEMO_MODE ):\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nif ( $authenticatedMember ):\n$return .= <<<CONTENT\n\n                        <div class='sm:ipsMargin_top:half' >\n                            \nCONTENT;\n\n$sprintf = array($authenticatedMember); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_signedin_as', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n (<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=signout\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_signout', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>)\n                        <\/div>\n                    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                        <div  class='sm:ipsMargin_top:half' data-controller=\"core.admin.marketplace.launcher\" data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $authenticationUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-error=\"\nCONTENT;\n$return .= htmlspecialchars( $authenticationError, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-height=\"800\">\n                            <button class=\"ipsButton ipsButton_primary\" \nCONTENT;\n\nif ( $authenticationError ):\n$return .= <<<CONTENT\ndata-action=\"showError\"\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\ndata-action=\"signIn\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_signin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n                        <\/div>\n                    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nelseif ( \\IPS\\DEMO_MODE ):\n$return .= <<<CONTENT\n\n                    <button class=\"ipsButton ipsButton_primary ipsButton_disabled ipsResponsive_showDesktop\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_demo_mode', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_signin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n                    <div class=\"ipsResponsive_hideDesktop sm:ipsMargin_top:half\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_demo_mode', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n                \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                    <button class=\"ipsButton ipsButton_primary ipsButton_disabled ipsResponsive_showDesktop\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_localhost_mode', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_signin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n                    <div class=\"ipsResponsive_hideDesktop sm:ipsMargin_top:half\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_localhost_mode', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !$file ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div data-controller=\"core.admin.marketplace.launcher\">\n\t\t\t\t\t<input type=\"search\" placeholder=\"\nCONTENT;\n\n$sprintf = array($title); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_search_placeholder', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\" data-role=\"searchBox\" size=\"35\">\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\n\t<\/div>\n<\/div>\n\n\nCONTENT;\n\nif ( $notification = \\IPS\\core\\AdminNotification::find('core', 'ConfigurationError', 'marketplaceSetup') ):\n$return .= <<<CONTENT\n\n<div class=\"ipsMessage ipsMessage_warning ipsMargin\">\n    <div class=\"ipsType_bold\">\nCONTENT;\n$return .= htmlspecialchars( $notification->title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n    {$notification->body()}\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction dashboard( $dataSet ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div data-role=\"hideWhenSearching\">\n\t<div class='ipsColumns ipsColumns_collapsePhone' data-ipsLazyLoad>\n\t\t<div class='ipsColumn ipsColumn_fluid'>\n\t        <h2>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_newest_files', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t        \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardList( $dataSet['newest'], 'full', TRUE );\n$return .= <<<CONTENT\n\n\t\n\t\t\t<h2 class=\"ipsMargin_top:double\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_popular_applications', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardList( $dataSet['popularApps'], 'full', TRUE );\n$return .= <<<CONTENT\n\n\t\n\t\t\t<h2 class=\"ipsMargin_top:double\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_popular_themes', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardList( $dataSet['popularThemes'], 'full', TRUE );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\n        \nCONTENT;\n\nif ( \\count( $dataSet['updated'] ) AND \\count( $dataSet['popularLanguages'] ) ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsColumn ipsColumn_wide'>\n\t\t\t<h2>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_recently_updated', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t        \nCONTENT;\n\nforeach ( $dataSet['updated'] as $file ):\n$return .= <<<CONTENT\n\n\t            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardMini( $file );\n$return .= <<<CONTENT\n\n\t        \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t        <h2>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_popular_languages', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t        \nCONTENT;\n\nforeach ( $dataSet['popularLanguages'] as $file ):\n$return .= <<<CONTENT\n\n\t        \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardMini( $file );\n$return .= <<<CONTENT\n\n\t        \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\n<div data-role=\"results\"><\/div>\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction fileCard( $file, $carousel=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $carousel ):\n$return .= <<<CONTENT\n\n<li class='ipsCarousel_item'>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<a class='ipsBox cFileCard cFileCard_large' data-file=\"\nCONTENT;\n$return .= htmlspecialchars( $file['id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=viewFile&id={$file['id']}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\n\t<span class=\"ipsThumb_bg ipsPosition:relative\" \nCONTENT;\n\nif ( $file['primaryScreenshotThumb'] ):\n$return .= <<<CONTENT\ndata-background-src=\"\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $file['primaryScreenshotThumb']['url'] );;\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t<span class=\"cFileCard_cost\">\n        \nCONTENT;\n\nif ( $file['isPaid'] ):\n$return .= <<<CONTENT\n\n            &#36;\nCONTENT;\n\n$return .= htmlspecialchars( number_format( $file['prices']['USD'], 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t    \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_free', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/span>\n\t<\/span>\n\n\t<div class=\"ipsPadding:half\">\n\t\t<h2 class=\"cFileCard_title ipsTruncate ipsTruncate_line\">\nCONTENT;\n$return .= htmlspecialchars( $file['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<span class=\"cFileCard_byLine\">\nCONTENT;\n\n$sprintf = array($file['author']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_card_byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\n        <div class=\"ipsMargin_top\">\n\t\t\t<div class=\"cFileCard_rating\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'medium', $file['rating'], 5 );\n$return .= <<<CONTENT\n\n\t\t\t\t<span>(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumberShort( $file['reviews'] );\n$return .= <<<CONTENT\n)<\/span>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n<\/a>\n\n\nCONTENT;\n\nif ( $carousel ):\n$return .= <<<CONTENT\n\n<\/li>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction fileCardList( $results, $type='full', $carousel=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( !\\count( $results ) ):\n$return .= <<<CONTENT\n\n    <p class=\"ipsType_normal ipsType_light ipsType_center\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_error_no_resources', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nif ( $carousel AND $type!='mini' ):\n$return .= <<<CONTENT\n\n    <div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots data-ipsLazyLoad>\n        <div class='ipsCarousel_inner'>\n            <ul class='cFileDashboardCarousel ipsClearfix' data-role=\"carouselItems\">\n    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n    <div class='ipsGrid ipsGrid_collapsePhone' data-ipsGrid data-ipsgrid-minitemsize=\"230\" data-ipsGrid-maxitemsize=\"400\" data-ipsGrid-equalheights=\"row\" data-ipsLazyload>\n    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nforeach ( $results as $result ):\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nif ( $type == 'mini' ):\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCardMini( $result );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \\IPS\\Request::i()->app )->fileCard( $result, ( $carousel AND $type=='full' ) );\n$return .= <<<CONTENT\n\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\n    \nCONTENT;\n\nif ( $carousel AND $type!='mini' ):\n$return .= <<<CONTENT\n\n            <\/ul>\n            <span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n            <span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n            <a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n            <a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n        <\/div>\n    <\/div>\n    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n    <\/div>\n    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction fileCardMini( $file ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<a class='ipsBox ipsMargin_bottom:half cFileCard cFileCard_mini ipsFlex'  href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=viewFile&id={$file['id']}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\">\n\t<span class=\"ipsThumb_bg ipsPosition:relative\" data-background-src=\"\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $file['primaryScreenshotThumb']['url'] );;\n$return .= <<<CONTENT\n\">\n        <span class=\"cFileCard_cost\">\n            \nCONTENT;\n\nif ( $file['isPaid'] ):\n$return .= <<<CONTENT\n\n                &#36;\nCONTENT;\n\n$return .= htmlspecialchars( number_format( $file['prices']['USD'], 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_free', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <\/span>\n\t<\/span>\n    <div class=\"ipsFlex-flex:11 ipsPadding:half ipsPosition:relative\">\n        <h2 class=\"cFileCard_title ipsTruncate ipsTruncate_line\">\nCONTENT;\n$return .= htmlspecialchars( $file['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n        <span class=\"cFileCard_byLine\">\nCONTENT;\n\n$sprintf = array($file['author']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_card_byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n        <div class=\"cFileCard_rating ipsPadding:half\">\n            \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'medium', $file['rating'], 5 );\n$return .= <<<CONTENT\n (\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumberShort( $file['reviews'] );\n$return .= <<<CONTENT\n)\n        <\/div>\n    <\/div>\n<\/a>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction fileChangelogGrid( $changeLogs=array() ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div class=\"ipsGrid ipsPad\" data-ipsGrid>\n\t\nCONTENT;\n\nforeach ( $changeLogs as $change ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsGrid_span6\">\n\t\t\t<h2 class=\"ipsType_large\">\nCONTENT;\n\n$sprintf = array($change['version']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_version_short', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n - \nCONTENT;\n\n$return .= htmlspecialchars( ( new \\IPS\\DateTime( $change['date'] ) )->relative(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<div class=\"ipsType_richText cFileColorReset\">\n                \nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $change['changelog'] ?? '' );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction fileView( $file, $reviews, $authorized, $installed, $updateAvailable, $licenseValid=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<section>\n    <div class='ipsSpacer_bottom'>\n        <div class='ipsCarousel ipsClearfix' data-ipsCarousel data-ipsCarousel-showDots>\n            <div class='ipsCarousel_inner'>\n                <ul class='cFileScreenshotCarousel ipsClearfix' data-role=\"carouselItems\">\n                    \nCONTENT;\n\nforeach ( $file['screenshotsThumbnails'] as $k => $f ):\n$return .= <<<CONTENT\n\n                    <li class='ipsCarousel_item ipsBox ipsPad_half cFileScreenshot' data-ipsLazyLoad>\n                        <span data-background-src='\nCONTENT;\n\n$return .= str_replace( array( '(', ')' ), array( '\\(', '\\)' ), $f['url'] );;\n$return .= <<<CONTENT\n' class=\"ipsThumb ipsThumb_medium ipsThumb_bg ipsCursor_pointer\" data-ipsLightbox data-ipsLightbox-group=\"download_\nCONTENT;\n$return .= htmlspecialchars( $file['id'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-fullURL=\"\nCONTENT;\n$return .= htmlspecialchars( $file['screenshots'][ $k ]['url'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n                            <img src='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Parser::blankImage(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-src=\"\nCONTENT;\n$return .= htmlspecialchars( $f['url'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" alt=\"\">\n                        <\/span>\n                    <\/li>\n                    \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n                <\/ul>\n            <\/div>\n            <span class='ipsCarousel_shadow ipsCarousel_shadowLeft'><\/span>\n            <span class='ipsCarousel_shadow ipsCarousel_shadowRight'><\/span>\n            <a href='#' class='ipsCarousel_nav ipsHide' data-action='prev'><i class='fa fa-chevron-left'><\/i><\/a>\n            <a href='#' class='ipsCarousel_nav ipsHide' data-action='next'><i class='fa fa-chevron-right'><\/i><\/a>\n        <\/div>\n    <\/div>\n<\/section>\n\n<div class='ipsColumns ipsColumns_collapseTablet cFileView' data-controller=\"core.admin.marketplace.launcher\" data-disclaimer-location=\"\nCONTENT;\n\nif ( isset( $file['disclaimerLocation'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $file['disclaimerLocation'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-category-type=\"\nCONTENT;\n$return .= htmlspecialchars( $file['category']['resourceType'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class='ipsColumn ipsColumn_fluid'>\n\n        \nCONTENT;\n\nif ( !empty( $file['supportTab'] ) ):\n$return .= <<<CONTENT\n\n        <div class='ipsTabs ipsTabs_small ipsTabs_stretch ipsClearfix' id='elMpTabs' data-ipsTabBar data-ipsTabBar-contentArea='#elMpTabs_content'>\n            <ul role=\"tablist\" class='ipsList_reset'>\n                <li>\n                    <a href='#' id='elMpTabDescription' class='ipsTabs_item ipsTabs_activeItem' data-role=\"descriptionTab\" role=\"tab\" aria-selected='true'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_tab_description', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n                <\/li>\n                <li>\n                    <a href='#' id='elMpTabSupport' class='ipsTabs_item' data-role=\"supportTab\" role=\"tab\" aria-selected='false'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_tab_support', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n                <\/li>\n            <\/ul>\n        <\/div>\n\n        <div id=\"elMpTabs_content\" class=\"ipsBox ipsTabs_panels ipsClearfix ipsPad ipsType_richText cFileColorReset\">\n            <div id=\"ipsTabs_elMpTabs_elMpTabDescription_panel\" class=\"ipsTabs_panel ipsAreaBackground_reset ipsClearfix\" aria-hidden=\"false\" data-role=\"descriptionTab\">\n                \nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $file['description'] );\n$return .= <<<CONTENT\n\n\n                \nCONTENT;\n\nif ( !empty( $file['extraResources'] ) ):\n$return .= <<<CONTENT\n\n                <h3 class=\"ipsSpacer_top ipsSpacer_double\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_extra_resource', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n                {$file['extraResources']}\n                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            <\/div>\n            <div id=\"ipsTabs_elMpTabs_elMpTabSupport_panel\" class=\"ipsTabs_panel ipsAreaBackground_reset ipsClearfix\" aria-hidden=\"false\" data-role=\"supportTab\">\n                \nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $file['supportTab'] ?? '' );\n$return .= <<<CONTENT\n\n            <\/div>\n        <\/div>\n        \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n        <div class=\"ipsBox ipsPad ipsType_richText cFileColorReset\">\n            \nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $file['description'] );\n$return .= <<<CONTENT\n\n        <\/div>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n        \nCONTENT;\n\nif ( $file['reviews'] ):\n$return .= <<<CONTENT\n\n        <h2>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_reviews', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n        <div class=\"ipsBox ipsPadding:half\">\n\t\t\t\nCONTENT;\n\nforeach ( $reviews['results'] as $review ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"cFileView_review\">\n\t\t\t\t<div class='ipsFlex ipsFlex-ai:center cFileView_reviewHeader'>\n\t\t\t\t\t<img src=\"\nCONTENT;\n$return .= htmlspecialchars( $review['author']['photoUrl'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsThumb_tiny\" width=\"50\" height=\"50\" alt=\"\">\n\t\t\t\t\t<div class=\"ipsFlex-flex:11 ipsPadding_left:half\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $review['author']['profileUrl'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" rel=\"external noopener\" target=\"_blank\">\nCONTENT;\n$return .= htmlspecialchars( $review['author']['name'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n                        \nCONTENT;\n\n$date = new \\IPS\\DateTime( $review['date'] ); \n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<br>\nCONTENT;\n\nif ( $date->getTimestamp() ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= $date->html();\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unknown_date', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\n\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'medium', $review['rating'], 5 );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/div>\n\t\t\t\t<div class=\"ipsType_richText ipsContained\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $review['content'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $review['authorResponse'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class='ipsReviewResponse ipsPadding ipsSpacer_bottom ipsAreaBackground_light ipsClearfix'>\n\t\t\t\t\t\t\t<h4 class='ipsType_sectionHead ipsType_medium ipsType_bold ipsSpacer_bottom ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'review_response_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t\t\t\t\t<div data-role=\"reviewResponse\" class=\"ipsType_richText ipsType_normal ipsContained ipsType_light\">\n                                \nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $review['authorResponse'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\n\t\t\t\nCONTENT;\n\nif ( $file['canReview'] ):\n$return .= <<<CONTENT\n\n\t\t\t<hr class=\"ipsHr\">\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $file['url'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n#replies\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"ipsButton ipsButton_positive\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_add_review', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n        <\/div>\n\t\t\nCONTENT;\n\nif ( $reviews['totalPages'] > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsSpacer_top\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->pagination( \\IPS\\Http\\Url::internal('app=core&module=marketplace&controller=marketplace&do=viewFile&id=' . $file['id'] ), $reviews['totalPages'], $reviews['page'], $reviews['perPage'], TRUE, 'page' );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\n\t<div class='ipsColumn ipsColumn_veryWide'>\n        \nCONTENT;\n\nif ( \\IPS\\IPS::canManageResources() ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsBox ipsPad ipsSpacer_bottom\">\n            \nCONTENT;\n\nif ( isset( $file['prices']['USD'] ) ):\n$return .= <<<CONTENT\n\n            <div class=\"ipsSpacer_bottom ipsType_center\">\n                <span class=\"ipsType_veryLarge\">&#36;\nCONTENT;\n\n$return .= htmlspecialchars( number_format( $file['prices']['USD'], 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\n                \nCONTENT;\n\nif ( isset( $file['renewalTermString'] ) ):\n$return .= <<<CONTENT\n\n                <div class=\"ipsType_large\">\nCONTENT;\n$return .= htmlspecialchars( $file['renewalTermString'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/div>\n                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            <\/div>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            \nCONTENT;\n\nif ( $authorized AND ( $licenseValid OR ( $file['isPaid'] AND $file['isPurchased'] AND $file['canDownload'] ) ) ):\n$return .= <<<CONTENT\n\n            <div class=\"ipsResponsive_hidePhone\">\n                \nCONTENT;\n\nif ( $installed AND $file['canDownload'] ):\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nif ( !$updateAvailable ):\n$return .= <<<CONTENT\n\n                        <span class=\"ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsResponsive_inline\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_already_installed', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n                    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                        <a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=install&id={$file['id']}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth\" data-role=\"update\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_update', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n                    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nif ( $file['canDownload'] ):\n$return .= <<<CONTENT\n\n                        <a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=install&id={$file['id']}&type=install\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth\" data-role=\"install\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_install', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n                    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nif ( $file['canBuy'] ):\n$return .= <<<CONTENT\n\n                        \nCONTENT;\n\nif ( !$file['isPurchasable'] ):\n$return .= <<<CONTENT\n\n                            <div class=\"ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsSpacer_top\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_purchasing_disabled', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n                        \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                        <div data-purchase-url=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=buyFile&id={$file['id']}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-height=\"900\">\n                            <button class='ipsButton ipsButton_fullWidth \nCONTENT;\n\nif ( $file['canDownload'] ):\n$return .= <<<CONTENT\nipsButton_veryLight ipsSpacer_top\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_important\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' data-action=\"launchWindow\" data-role=\"purchase\">\n                                <i class='fa fa-shopping-cart'><\/i> &nbsp;\nCONTENT;\n\nif ( $file['canDownload'] OR \\count( $file['pendingInvoices'] ?? [] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_buy_another', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_buy_now', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                            <\/button>\n                        <\/div>\n                        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n                \nCONTENT;\n\nif ( isset( $file['pendingInvoices'] ) AND \\count( $file['pendingInvoices'] ) AND $licenseValid ):\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nif ( \\count( $file['pendingInvoices'] ) === 1 ):\n$return .= <<<CONTENT\n\n                        \nCONTENT;\n\nforeach ( $file['pendingInvoices'] as $invoiceId => $invoice ):\n$return .= <<<CONTENT\n\n                        <a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=renewFile&id={$file['id']}&invoiceId={$invoiceId}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_fullWidth ipsButton_large ipsButton_veryLight ipsSpacer_top' data-role=\"renew\"><i class='fa fa-refresh'><\/i> &nbsp;\nCONTENT;\n\n$sprintf = array($invoice['total']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_renew_now_invoice', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a>\n                        \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n                    \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                    <a href='#elFileRenew_menu' id='elFileRenew' class='ipsButton ipsButton_fullWidth ipsButton_large ipsButton_veryLight ipsSpacer_top' data-ipsMenu><i class='fa fa-refresh'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_renew_now', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/a>\n                    <ul id='elFileRenew_menu' class='ipsMenu ipsMenu_auto ipsHide'>\n                        \nCONTENT;\n\nforeach ( $file['pendingInvoices'] as $id => $invoice ):\n$return .= <<<CONTENT\n\n                        <li class='ipsMenu_item'><a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=renewFile&id={$file['id']}&invoiceId={$id}\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-role=\"renew\">\nCONTENT;\n\n$sprintf = array($id, $invoice['total']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_renew_now_invoice_id', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n                        \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n                    <\/ul>\n                    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n                \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n            <\/div>\n            <span class=\"ipsType_light ipsType_blendLinks ipsResponsive_showPhone ipsResponsive_hideTablet ipsResponsive_hideDesktop\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_no_phones', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n            \nCONTENT;\n\nelseif ( $authorized AND !$licenseValid  ):\n$return .= <<<CONTENT\n\n                <span class=\"ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsResponsive_inline\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_inactive_license', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n            \nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n                <span class=\"ipsType_light ipsType_blendLinks ipsResponsive_hidePhone ipsResponsive_inline\"><i class=\"fa fa-info-circle\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_must_sign_in', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n            \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n        \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n        <h2>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_resource_information', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n        <div class=\"ipsBox ipsPad\">\n\n            <ul class=\"ipsDataList ipsDataList_reducedSpacing\">\n\n\t\t\t\t<li class=\"ipsDataItem\">\n\t\t\t\t\t<span class=\"ipsDataItem_generic ipsDataItem_size3\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_file_rating', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'front' )->rating( 'medium', $file['rating'], 5 );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span>(\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumberShort( $file['reviews'] );\n$return .= <<<CONTENT\n)<\/span><\/span>\n\t\t\t\t<\/li>\n                \nCONTENT;\n\nif ( $file['isPurchasable'] ):\n$return .= <<<CONTENT\n\n                <li class=\"ipsDataItem\">\n                    <span class=\"ipsDataItem_generic ipsDataItem_size3\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_file_purchases', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n                    <span class=\"ipsDataItem_generic\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $file['purchases'] );\n$return .= <<<CONTENT\n<\/span>\n                <\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n                <li class=\"ipsDataItem\">\n                    <span class=\"ipsDataItem_generic ipsDataItem_size3\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_file_downloads', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n                    <span class=\"ipsDataItem_generic\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $file['downloads'] );\n$return .= <<<CONTENT\n<\/span>\n                <\/li>\n\n                <li class=\"ipsDataItem\">\n                    <span class=\"ipsDataItem_generic ipsDataItem_size3\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_file_submitted', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n                    <span class=\"ipsDataItem_generic\">\nCONTENT;\n\n$return .= (new \\IPS\\DateTime($file['date']))->html();\n$return .= <<<CONTENT\n<\/span>\n                <\/li>\n\n                <li class=\"ipsDataItem\">\n                    <span class=\"ipsDataItem_generic ipsDataItem_size3\"><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_file_updated', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n                    <span class=\"ipsDataItem_generic\">\nCONTENT;\n\n$return .= (new \\IPS\\DateTime($file['updated']))->html();\n$return .= <<<CONTENT\n<\/span>\n                <\/li>\n\t\t\t<\/ul>\n        <\/div>\n\n\t\t\nCONTENT;\n\nif ( $file['changelog'] ):\n$return .= <<<CONTENT\n\n\t\t<h2>\nCONTENT;\n\n$sprintf = array($file['version']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_changes_version', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t<div class=\"ipsBox ipsPad ipsType_richText cFileColorReset cFileChangelog\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\core\\modules\\admin\\marketplace\\marketplace::_parseRawContent( $file['changelog'] );\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=fileChangelog&id={$file['id']}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_previous_changes', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_alternate ipsButton_fullWidth ipsButton_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_previous_changes', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\n\nCONTENT;\n\nif ( !empty( $file['downloadDisclaimer'] ) ):\n$return .= <<<CONTENT\n\n<div class=\"ipsHide\">\n    \nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"marketplace\", \"core\", 'admin' )->termsAndConditions( $file, '', $file['downloadDisclaimer'], $file['authorDisclaimer'] ?? '', $file['author']['name'] );\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction onboardRow( $id, $marketplaceId, $category, $title, $version, $author, $website, $type ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<tr data-controller=\"core.admin.marketplace.onboardRow\" data-id=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-marketplaceId=\"\nCONTENT;\n$return .= htmlspecialchars( $marketplaceId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-title=\"\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-category=\"\nCONTENT;\n$return .= htmlspecialchars( $category, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<td style=\"width: 40%\">\n\t\t<div class=\"ipsPad_all:half\">\n\t\t\t<h4 class=\"ipsContained ipsType_break ipsType_reset\">\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $version ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span class='ipsType_small ipsType_unbold ipsType_light'>\nCONTENT;\n$return .= htmlspecialchars( $version, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/h4>\n\t\t\t\nCONTENT;\n\nif ( $author or $website ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsType_light ipsContained ipsType_break\">\n\t\t\t\t\t\nCONTENT;\n\nif ( $author ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($author); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline_nodate', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $website ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class='ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->basicUrl( $website, TRUE, $website, FALSE, TRUE, TRUE );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/td>\n\t<td style=\"width: 40%\">\n\t\t<div data-role=\"onboardLoading\">\n\t\t\t<i class='icon-spinner2 ipsLoading_tinyIcon'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'loading', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div data-role=\"matchedFile\" class=\"ipsAreaBackground_light\" style=\"max-width: 250px\">\n\t\t\t\n\t\t<\/div>\n\t\t<div data-role=\"noMatchedFile\" class=\"ipsHide\">\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_no_results', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/td>\n\t<td style=\"width: 20%\">\n\t\t<input type=\"hidden\" name=\"match_\nCONTENT;\n$return .= htmlspecialchars( $type, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n[\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $marketplaceId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"id\">\n\t\t<input type=\"hidden\" name=\"confirmed[\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"\nCONTENT;\n\nif ( $marketplaceId ):\n$return .= <<<CONTENT\n1\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n0\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" data-role=\"confirm\">\n\t\t<div data-role=\"confirm_match\" class=\"ipsHide ipsSpacer_top\">\n\t\t\t<button class=\"ipsButton ipsButton_positive ipsButton_verySmall\" data-action=\"confirmMatch\"><i class=\"fa fa-check\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_match', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t\t&nbsp;\n\t\t\t<button class=\"ipsButton ipsButton_negative ipsButton_verySmall\" data-ipsMenu id=\"elOnboardMatched\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><i class=\"fa fa-times\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_no_match', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/button>\n\t\t\t<ul id=\"elOnboardMatched\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\" class=\"ipsMenu ipsMenu_narrow ipsHide\">\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"searchMarketplace\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_search', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"confirmCustom\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_custom', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t<div data-role=\"confirm_nomatch\" class=\"ipsHide\">\n\t\t\t<button class=\"ipsButton ipsButton_primary ipsButton_verySmall\" data-ipsMenu id=\"elOnboardNotMatched\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_match', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/button>\n\t\t\t<ul id=\"elOnboardNotMatched\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\" class=\"ipsMenu ipsMenu_narrow ipsHide\">\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"searchMarketplace\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_search', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"confirmCustom\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_custom', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t<div data-role=\"confirmed\" class=\"\nCONTENT;\n\nif ( !$marketplaceId ):\n$return .= <<<CONTENT\nipsHide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t<span class=\"ipsType_success\"><i class=\"fa fa-check\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_confirmed', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span> &nbsp; <a href=\"#\" class=\"ipsType_small ipsType_light\" data-ipsMenu id=\"elOnboardChange\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'change', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class=\"fa fa-caret-down\"><\/i><\/a>\n\t\t\t<ul id=\"elOnboardChange\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_menu\" class=\"ipsMenu ipsMenu_narrow ipsHide\">\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"searchMarketplace\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_search', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t\t <li class=\"ipsCursor_pointer ipsMenu_item\" data-ipsMenuValue=\"confirmCustom\">\n\t\t\t\t \t<a href=\"#\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_custom', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t <\/li>\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/td>\n<\/tr>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction onboardSearch( $category, $compatible=TRUE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller=\"core.admin.marketplace.search\" data-category=\"\nCONTENT;\n$return .= htmlspecialchars( $category, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-compatible=\"\nCONTENT;\n$return .= htmlspecialchars( $compatible, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-search-literal=\"true\">\n\t<div class=\"ipsPad ipsAreaBackground\">\n\t\t<input type=\"search\" class=\"ipsField_fullWidth\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_search', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-role=\"searchBox\">\n\t<\/div>\n\t<div class=\"ipsAreaBackground ipsPadding\" data-role=\"results\"><\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction onboardTemplate( $rows ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<form action=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=onboard\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\" method=\"post\" data-controller=\"core.admin.marketplace.onboard\">\n\t<table class=\"ipsTable ipsTable_responsive ipsTable_zebra\">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_installed', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/th>\n\t\t\t\t<th>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_onboard_possible', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/th>\n\t\t\t\t<th><\/th>\n\t\t\t<\/tr>\n\t\t<\/thead>\n\t\t<tbody>\n\t\t\t\nCONTENT;\n\nforeach ( $rows as $row ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$row}\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/tbody>\n\t<\/table>\n\t<div class=\"ipsAreaBackground ipsClearfix ipsPad ipsType_center\">\n\t\t<button type=\"submit\" class=\"ipsButton ipsButton_primary\" data-role=\"continueButton\" class=\"ipsButton_disabled\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'continue', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/button>\n\t<\/div>\n<\/form>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction termsAndConditions( $file, $type, $marketplaceTcs, $authorTcs='' ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<div id=\"downloadTerms\" data-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_terms_and_conditions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n<div class=\"ipsSpacer_bottom\">\n\t<div class=\"ipsPad\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->richText( $marketplaceTcs, array('ipsType_medium') );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( !empty( $authorTcs ) ):\n$return .= <<<CONTENT\n\n\t<h3 class=\"ipsDialog_title\">\n\t\t\nCONTENT;\n\n$sprintf = array($file['author']['name']); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_author_terms', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t<\/h3>\n\t<hr class=\"ipsHr\">\n\t<div class=\"ipsPadding\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\", 'global' )->richText( $authorTcs, array('ipsType_medium') );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class='ipsAreaBackground ipsType_right ipsPad'>\n\t\t<ul class='ipsList_inline'>\n\t\t\t<li><a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=viewFile&id={$file['id']}\", null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_medium' data-action='dialogClose'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cancel', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<li><a href='\nCONTENT;\n\nif ( $type=='purchase' ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=buyFile&id={$file['id']}&confirm=1\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( \"app=core&module=marketplace&controller=marketplace&do=install&id={$file['id']}&confirm=1\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', TRUE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_primary ipsButton_medium' data-action='acceptDisclaimer' id=\"test\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'marketplace_agree_and_proceed', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/ul>\n\t<\/div>\n<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
